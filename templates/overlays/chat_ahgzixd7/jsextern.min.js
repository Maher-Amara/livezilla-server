var lz_chat_full_load=true;var lz_chat_status_change=true;var lz_chat_status=-1;var lz_chat_last_message_received=null;var lz_chat_last_poster=null;var lz_sound_player=null;var lz_ticket=null;var lz_flood=false;var lz_timer_typing=null;var lz_timer_connecting=null;var lz_header_text="";var lz_chat_waiting_posts_timer;var lz_chat_invite_timer=null;var lz_chat_scrolled=false;var lz_leave_chat=false;var lz_chat_human_available=false;var lz_chat_declined=false;var lz_chat_init_feedback=false;var lz_mode_show_options=false;var lz_chat_kb_last_search_phrase="";var lz_chat_kb_search_phrase="";var lz_chat_kb_sound_played=false;var lz_chat_et_attempt=false;var lz_default_meta=null;var lz_default_overflow="";var lz_chat_overlay_pointer=null;var lz_operator_typing=false;var lz_hide_widget_by_conf=false;var lz_first_call=true;var lz_chat_option_function;var lz_mode_phone_outbound=false;var lz_mode_phone_inbound=false;var lz_mode_chat_login=false;if(typeof OverlayChatWidgetV2!="undefined"){var lz_external=new lz_chat_external_user();OverlayChatWidgetV2.__Ratio=1;if(typeof lz_ovlel_rat!="undefined"){OverlayChatWidgetV2.__Ratio=lz_ovlel_rat}OverlayChatWidgetV2.__SizeWidth=Math.floor(48*OverlayChatWidgetV2.__Ratio);OverlayChatWidgetV2.__SizeHeight=Math.floor(48*OverlayChatWidgetV2.__Ratio);OverlayChatWidgetV2.__Border=0;OverlayChatWidgetV2.__Space=Math.floor(5*OverlayChatWidgetV2.__Ratio);OverlayChatWidgetV2.__Scale=".0"+Math.floor(14*OverlayChatWidgetV2.__Ratio).toString();OverlayChatWidgetV2.__ModeCombi=false;OverlayChatWidgetV2.__ModeSingle=false;OverlayChatWidgetV2.__ModeClassic=false;OverlayChatWidgetV2.__ModeAPI=false;OverlayChatWidgetV2.__ModeFeedback=false;OverlayChatWidgetV2.__ModeTOS=false;OverlayChatWidgetV2.__ModeTicketReceived=false;OverlayChatWidgetV2.__ModeChangeDetails=false;OverlayChatWidgetV2.__ModeBot=false;OverlayChatWidgetV2.__ModeTextInline=false;OverlayChatWidgetV2.__FormConfirmRequired=false;OverlayChatWidgetV2.__FormVisible=false;OverlayChatWidgetV2.__TicketRequired=false;OverlayChatWidgetV2.__CurrentChatId=0;OverlayChatWidgetV2.__LastChatId=0;OverlayChatWidgetV2.__PostsNoticed=lz_is_mobile;OverlayChatWidgetV2.__LastPostReceived=null;OverlayChatWidgetV2.__IsPostStatusUpdate=false;OverlayChatWidgetV2.__IsWaitingForNotice=false;OverlayChatWidgetV2.__NoBotChat=false;OverlayChatWidgetV2.__Connecting=false;OverlayChatWidgetV2.__CurrentGroup=null;OverlayChatWidgetV2.ChatInitiated=false;OverlayChatWidgetV2.ChatStarted=false;OverlayChatWidgetV2.ChatEnded=false;OverlayChatWidgetV2.CurrentOperator=null;OverlayChatWidgetV2.TargetGroupId=null;OverlayChatWidgetV2.TargetOperatorId=null;OverlayChatWidgetV2.AcceptTOS=false;OverlayChatWidgetV2.AcceptCR=false;OverlayChatWidgetV2.DeclineCR=false;OverlayChatWidgetV2.InputBlocked=false;OverlayChatWidgetV2.FeedbackOnMouseMove=false;OverlayChatWidgetV2.MouseMoveEvent=null;OverlayChatWidgetV2.TranslateErrorTimer=null;OverlayChatWidgetV2.DoneTranslateCallback=null;OverlayChatWidgetV2.ButtonTexts=null;OverlayChatWidgetV2.RoomMembers=[];OverlayChatWidgetV2.Screenshot=null;OverlayChatWidgetV2.ScreenCaptureToStartChat=false;OverlayChatWidgetV2.FileUploadToStartChat=false;OverlayChatWidgetV2.RemoveAttachmentId=null;OverlayChatWidgetV2.PostPreview=null;OverlayChatWidgetV2.Margin=[0,0,0,0];OverlayChatWidgetV2.PreviewTextControl=false;OverlayChatWidgetV2.QueueTime=0;OverlayChatWidgetV2.QueuePosition=0;OverlayChatWidgetV2.ChatLoadingElement=null;if(typeof lz_ovlel_text_inline!="undefined"){if(lz_global_get_window_width()>500){OverlayChatWidgetV2.__ModeTextInline=!lz_ovlel_fsm}else{lz_border_radius=6}}document.addEventListener("mousemove",function(a){OverlayChatWidgetV2.MouseMove(a)},false);function lz_chat_unset_focus(){try{if(LiveZillaData.InputFieldIndices!=null){if(document.getElementById("lz_chat_data_form").style.display!="none"){for(var c=0;c<LiveZillaData.InputFieldIndices.length;c++){var a=LiveZillaData.InputFieldIndices[c];if(document.getElementById("lz_form_"+a)!=null&&document.getElementById("lz_form_"+a).style.display!="none"){document.getElementsByName("form_"+a)[0].blur()}}}else{document.getElementById("lz_chat_text").blur()}}}catch(b){}}function lz_chat_set_focus(c){try{if(lz_mode_show_options||lz_is_mobile){return}if(lz_chat_is_visible()&&LiveZillaData.InputFieldIndices!=null){var b=null;if(document.getElementById("lz_chat_data_form").style.display!="none"){for(var e=0;e<LiveZillaData.InputFieldIndices.length;e++){var a=LiveZillaData.InputFieldIndices[e];if(document.getElementById("lz_form_"+a)!=null&&document.getElementById("lz_form_"+a).style.display!="none"){if(document.getElementsByName("form_"+a)[0].value==""){b=document.getElementsByName("form_"+a)[0];break}}}}else{b=document.getElementById("lz_chat_text")}if(b!=null){lz_chat_set_focus_ctrl(b)}}}catch(d){}}function lz_chat_set_focus_ctrl(b){try{b.focus();var c=b.value;b.value="";b.value=c}catch(a){}}function lz_chat_switch_details(a){if(!a&&OverlayChatWidgetV2.__ModeChangeDetails){if(lz_session.OVLWMSElem=="chat"){LiveZillaData.WriteToServer=true;LiveZilla.Engine.Poll(1112)}}OverlayChatWidgetV2.__ModeChangeDetails=!OverlayChatWidgetV2.__ModeChangeDetails;OverlayChatWidgetV2.UpdateUI();OverlayChatWidgetV2.UpdateButtonUI();lz_chat_set_focus(1)}function lz_chat_update_name(){var a=lz_chat_get_input_value(111);if(lz_global_trim(a)==""){a=lz_guest_name}for(var c=0;c<document.getElementById("lz_chat_content_box").getElementsByTagName("DIV").length;c++){var b=document.getElementById("lz_chat_content_box").getElementsByTagName("DIV")[c].getAttribute("data-my");if(b==1){if(document.getElementById("lz_chat_content_box").getElementsByTagName("DIV")[c].className.indexOf("lz_overlay_chat_message_name_external")!=-1){document.getElementById("lz_chat_content_box").getElementsByTagName("DIV")[c].getElementsByTagName("SPAN")[0].innerHTML=lz_global_htmlentities(a)}else{if(document.getElementById("lz_chat_content_box").getElementsByTagName("DIV")[c].className.indexOf("lz_overlay_chat_message_avatar_external")!=-1){document.getElementById("lz_chat_content_box").getElementsByTagName("DIV")[c].getElementsByTagName("DIV")[0].style.backgroundImage="url('"+lz_poll_server+"picture.php?name="+lz_global_base64_url_encode(a)+"&ebg="+lz_global_base64_url_encode(lz_color_primary)+"')"}}}}}function lz_global_get_time(a){if(!a.toString().length||isNaN(a)){return""}a=parseInt(a)-lz_server_time_diff;var b=new Date(parseInt(a)*1000);var c=b.toLocaleTimeString();if(c=="Invalid Date"){return a}return c}function lz_chat_replace_icon(){for(var a=0;a<document.getElementById("lz_chat_content_box").getElementsByTagName("span").length;a++){if(document.getElementById("lz_chat_content_box").getElementsByTagName("span")[a].className=="lz_overlay_chat_message_change"){document.getElementById("lz_chat_content_box").getElementsByTagName("span")[a].innerHTML=lz_get_icon("","pencil","","")}}}function lz_chat_switch_options_table(a){lz_chat_switch_icon_toggle("lz_chat_switch_so",lz_session.OVLCSound==1);lz_chat_switch_icon_toggle("lz_chat_switch_tr",lz_session.TransFrom!="");lz_chat_update_transcript_ui();document.getElementById("lz_chat_options_table").style.display=(document.getElementById("lz_chat_options_table").style.display=="none"&&!a)?"":"none";document.getElementById("lz_chat_overlay_bottom").style.opacity=document.getElementById("lz_chat_content_box").style.opacity=(document.getElementById("lz_chat_options_table").style.display!="none")?0.2:1;document.getElementById("lz_cf_ec").style.display=(OverlayChatWidgetV2.__CurrentChatId!=0&&(lz_chat_status==1||lz_chat_status==2))?"block":"none";OverlayChatWidgetV2.UpdateChatFunctions()}function lz_chat_set_translation(b,c,a){if(lz_overlay_chat!=null){if(a!=null){a=lz_global_base64_decode(a).toLowerCase();a=(a.length==0)?null:a}if(c!=null){c=lz_global_base64_decode(c).toLowerCase();c=(c.length==0)?null:"AUTO"}if(b!=null&&lz_session.TransSID!=b){if(b!=null){lz_session.TransSID=b}if(a!=null){lz_session.TransInto=a}if(c!=null){lz_session.TransFrom=c}else{lz_session.TransFrom=""}lz_session.Save()}lz_chat_update_translation_ui()}}function lz_chat_update_translation_ui(){var a=lz_session.TransFrom!="";lz_chat_switch_icon_toggle("lz_chat_switch_tr",a)}function lz_chat_update_transcript_ui(){var a=lz_session.Transcript==1&&lz_chat_get_input_value(112)!="";lz_chat_switch_icon_toggle("lz_chat_switch_et",a)}function lz_chat_switch_translation(){lz_session.TransFrom=(lz_session.TransFrom=="")?"AUTO":"";lz_session.Save();lz_chat_update_translation_ui()}function lz_chat_switch_transcript(c){var b=lz_chat_get_input_value(112)!="";if(lz_session.Transcript==1&&!b){lz_session.Transcript=0}var a=lz_session.Transcript;lz_session.Transcript=(lz_session.Transcript==1||!b)?0:1;lz_session.Save();lz_chat_update_transcript_ui();if(a==0&&lz_chat_get_input_value(112)==""&&!c){lz_chat_et_attempt=true;lz_chat_switch_options_table(true,2);lz_chat_switch_details(false);document.getElementsByName("form_112")[0].focus()}LiveZillaData.WriteToServer=true;LiveZilla.Engine.Poll(5532)}function lz_chat_switch_sound(){lz_session.OVLCSound=lz_session.OVLCSound==1?0:1;lz_session.Save();lz_chat_switch_icon_toggle("lz_chat_switch_so",lz_session.OVLCSound==1)}function lz_chat_switch_icon_toggle(b,a){document.getElementById(b).getElementsByTagName("path")[0].setAttribute("d",lz_get_icon_path(a?"toggle-on":"toggle-off"));document.getElementById(b).style.fill=(a)?lz_color_primary:"var(--lz-icon-color)"}function lz_chat_fade_options(a){var b=parseInt((lz_overlay_chat_height-80)-parseInt(document.getElementById("lz_chat_overlay_options_box").style.height.replace("px","")));document.getElementById("lz_chat_overlay_options_box").style.top=(b/2)+"px";document.getElementById("lz_chat_overlay_options_frame").style.display=document.getElementById("lz_chat_overlay_options_box_bg").style.display=document.getElementById("lz_chat_overlay_options_box").style.display=(a)?"block":"none"}function lz_chat_print(){var a=lz_poll_server+"print.php?c="+lz_global_base64_url_encode(OverlayChatWidgetV2.__LastChatId)+"&b="+lz_global_base64_url_encode(lz_session.UserId+"_OVL")+"&i="+lz_global_base64_url_encode(lz_session.UserId)+"&r="+Math.random().toString();OverlayChatWidgetV2.OpenWindow(a,false)}function lz_chat_set_typing(c,b){if(lz_overlay_chat!=null){if(OverlayChatWidgetV2.__ModeBot){c=null}if(OverlayChatWidgetV2.__Connecting){if(!b&&lz_timer_connecting!=null){return}if(document.getElementById("lz_chat_overlay_info").innerHTML.length==0){document.getElementById("lz_chat_overlay_info").innerHTML=lz_text_connecting_info}else{document.getElementById("lz_chat_overlay_info").innerHTML=""}lz_timer_connecting=setTimeout(function(){lz_chat_set_typing("",true)},700)}else{if(lz_timer_connecting!=null){clearTimeout(lz_timer_connecting)}lz_timer_connecting=null;if(OverlayChatWidgetV2.CurrentOperator!=null&&c!=null&&!lz_operator_typing){var a=function(e,f){var d=document.createElement("div");d.id=e;var g=((lz_chat_last_poster!=OverlayChatWidgetV2.CurrentOperator.Id)?lz_global_base64_decode(lz_post_html):lz_global_base64_decode(lz_add_html));g=g.replace("<!--message-->",'<div class="lz_anim_point_load" style="padding:5px 0 0 0 !important;"><span></span><span></span><span></span></div>');g=g.replace("<!--server-->",lz_poll_server);g=g.replace("name=<!--ename-->&ebg=<!--bgce-->","operator="+encodeURIComponent(OverlayChatWidgetV2.CurrentOperator.Id));g=g.replace("<!--time-->","");g=g.replace("lz_overlay_chat_message_change","");g=g.replace("<!--name-->",lz_global_htmlentities(OverlayChatWidgetV2.CurrentOperator.Fullname));d.innerHTML=g;if(f){d.classList.add("lz_preview_message")}return d};lz_operator_typing=true;document.getElementById("lz_chat_content_inlay").appendChild(a("lz_chat_overlay_typing_post"));if(OverlayChatWidgetV2.PreviewTextControl){document.getElementById("lz_overlay_preview_messages").appendChild(a("lz_chat_overlay_typing_post_preview",true))}OverlayChatWidgetV2.ScrollDown(12834)}else{if(c==null&&lz_operator_typing&&document.getElementById("lz_chat_overlay_typing_post")!=null){lz_operator_typing=false;document.getElementById("lz_chat_content_inlay").removeChild(document.getElementById("lz_chat_overlay_typing_post"));delete document.getElementById("lz_chat_overlay_typing_post");if(document.getElementById("lz_chat_overlay_typing_post_preview")!=null){document.getElementById("lz_overlay_preview_messages").removeChild(document.getElementById("lz_chat_overlay_typing_post_preview"));delete document.getElementById("lz_chat_overlay_typing_post_preview")}}}}}}function lz_chat_switch_extern_typing(b){if(OverlayChatWidgetV2.__ModeBot){b=false}var a=(b!=lz_external.Typing);if(b){OverlayChatWidgetV2.__PostsNoticed=true;if(lz_timer_typing!=null){clearTimeout(lz_timer_typing)}lz_timer_typing=setTimeout(function(){lz_chat_switch_extern_typing(false)},5000)}lz_external.Typing=b;if(a&&OverlayChatWidgetV2.CurrentOperator!=null){LiveZilla.Engine.Poll(1115)}}function lz_kb_set_url(a){document.getElementById("lz_overlay_module_knowledgebase").style.display="block";var b=lz_poll_server+"knowledgebase.php?no-logo=MQ__&etc="+lz_global_base64_url_encode(lz_color_secondary)+"&ptl="+LiveZillaData.Language+"&ckf="+lz_kb_root;if(!lz_overlay_chat.m_FullScreenMode){b+="&tops=MQ__"}if(a!=""){b+="&search-for="+a}document.getElementById("lz_overlay_module_knowledgebase").getElementsByTagName("iframe")[0].src=b}function lz_chat_set_members(b,g,c){if(g&&lz_global_get_window_width(true)<600){g=false}document.getElementById("lz_chat_members_box").style.display=g?"block":"none";document.getElementById("lz_chat_content_box").style.left=!g?"0":"201px";if(g){if(lz_session.OVLWMState=="1"&&!lz_overlay_chat.m_FullScreenMode){document.getElementById("lz_overlay_chat").style.width="600px"}lz_overlay_chat_width=600}var m=false,o,h="",p="";for(var d=0;d<c.length;d++){var a=lz_guest_name;if(lz_d(c[d])&&lz_d(c[d].name)){if(c[d].name.length&&lz_global_base64_url_decode(c[d].name).length){a=lz_global_base64_url_decode(c[d].name)}var l=(!c[d].op)?"name="+lz_global_base64_url_encode(a):"operator="+encodeURIComponent(c[d].id);o="<div><span style=\"background-image: url('"+lz_poll_server+"picture.php?"+l+"');\"></span>"+lz_substr(a,18,true)+"</div>";if(c[d].op){p+=o}else{h+=o}}}if(lz_chat_status==2&&b!=null){OverlayChatWidgetV2.__PublicGroupChat=b}var f=(p.length)?p+""+h:h;if(document.getElementById("lz_chat_members_box").innerHTML!=f){document.getElementById("lz_chat_members_box").innerHTML=f}for(e=0;e<OverlayChatWidgetV2.RoomMembers.length;e++){n=false;for(j=0;j<c.length;j++){if(OverlayChatWidgetV2.RoomMembers[e].id==c[j].id){n=true}}if(!n){if(lz_external.Id==""||lz_external.Id==OverlayChatWidgetV2.RoomMembers[e].id){continue}m=true;OverlayChatWidgetV2.AddSystemMessage(lz_text_left.replace("<!--intern_name-->",lz_global_base64_url_decode(OverlayChatWidgetV2.RoomMembers[e].name)))}}for(var e=0;e<c.length;e++){var n=false;for(var j=0;j<OverlayChatWidgetV2.RoomMembers.length;j++){if(c[e].id==OverlayChatWidgetV2.RoomMembers[j].id){n=true}}if(!n){if(lz_external.Id==""||lz_external.Id==c[e].id){continue}m=true;if(!OverlayChatWidgetV2.RoomMembers.length){OverlayChatWidgetV2.AddSystemMessage(lz_text_speaking_to.replace("<!--operator_name-->",lz_global_base64_url_decode(c[e].name)))}else{OverlayChatWidgetV2.AddSystemMessage(lz_text_arrives.replace("<!--intern_name-->",lz_global_base64_url_decode(c[e].name)))}}}OverlayChatWidgetV2.UpdateChatHistoryUI();OverlayChatWidgetV2.RoomMembers=c;if(m){OverlayChatWidgetV2.ScrollDown(24214)}}function lz_chat_data_form_result(){if(lz_session.OVLWMSElem=="chat"&&!OverlayChatWidgetV2.IsChatAvailable()){OverlayChatWidgetV2.SetMode("ticket",false);return}OverlayChatWidgetV2.__FormConfirmRequired=false;if(OverlayChatWidgetV2.__ModeTicketReceived){lz_load_inputs=true;LiveZilla.Engine.Poll(1027);OverlayChatWidgetV2.__ModeTicketReceived=false;OverlayChatWidgetV2.UpdateUI();lz_chat_set_focus(7)}else{if(OverlayChatWidgetV2.__ModeChangeDetails){lz_chat_switch_details(false);if(lz_chat_et_attempt){lz_chat_et_attempt=false;lz_chat_switch_transcript(true)}}else{if(lz_session.OVLWMSElem=="chat"){OverlayChatWidgetV2.StartChat()}else{if(lz_session.OVLWMSElem=="ticket"){lz_chat_send_ticket()}else{if(lz_session.OVLWMSElem=="phone"){lz_chat_send_ticket(true)}}}}}}function lz_chat_update_kb_counter(a){if(document.getElementById("livezilla_wm_c_knowledgebase")!==null){document.getElementById("livezilla_wm_c_knowledgebase").style.display=(a>0)?"table-cell":"none";document.getElementById("livezilla_wm_c_knowledgebase").innerHTML=a}}function lz_chat_init_search_kb(){var a=lz_chat_get_input_value(114);if(lz_session.KBS!=1||a.length<12){return}if(a!=lz_chat_kb_last_search_phrase){lz_shared_kb_last_search_time=lz_global_timestamp();lz_chat_kb_last_search_phrase=lz_chat_kb_search_phrase=a;LiveZilla.Engine.Poll(1241)}}function lz_chat_search_result(a,b){lz_chat_kb_search_phrase="";document.getElementById("lz_chat_kb_match_info").style.display=(b>0)?"block":"none";if(b>0&&!lz_chat_kb_sound_played){OverlayChatWidgetV2.PlaySound(OverlayChatWidgetV2.NotificationSound);lz_chat_kb_sound_played=true}lz_kb_set_url(document.getElementsByName("form_114")[0].value);lz_chat_update_kb_counter(b)}function lz_chat_post(){this.MessageText="";this.MessageTranslationText="";this.MessageId="";this.Received=false}function lz_chat_operator(){this.Id="";this.Fullname="";this.Group="";this.Language="en"}function lz_chat_external_user(){this.Id="";this.Username="";this.Email="";this.Company="";this.Question="";this.Typing=false;this.MessagesSent=[]}function lz_chat_mail_callback(a){lz_chat_loading(false);OverlayChatWidgetV2.__ModeTicketReceived=true;document.getElementById("lz_chat_ticket_received").style.display=(a)?"":"none";document.getElementById("lz_chat_ticket_flood").style.display=(!a)?"":"none";if(a){document.getElementsByName("form_114")[0].value="";lz_ticket=null}else{lz_flood=true}OverlayChatWidgetV2.UpdateUI()}function lz_chat_send_ticket(){lz_chat_save_input_value(114,document.getElementsByName("form_114")[0].value);if(lz_check_missing_inputs(true,"lz_chat_send_ticket")){lz_chat_loading(true);lz_ticket=lz_global_timestamp();LiveZillaData.WriteToServer=true;setTimeout(function(){OverlayChatWidgetV2.AnswerChatRequest(true,true)},500)}}function lz_chat_loading(a){var b=(a!=(document.getElementById("lz_chat_overlay_loading").style.display=="block"));document.getElementById("lz_chat_overlay_loading").style.display=(a)?"block":"none";if(b){if(a){lz_chat_unset_focus()}else{lz_chat_set_focus(43)}}}function lz_check_missing_inputs(h,l){if(LiveZillaData.InputFieldIndices==null){return false}var j=false,p=false,c=false;var b=(lz_session.OVLWMSElem=="chat")?OverlayChatWidgetV2.__CurrentGroup.ChatInputsMandatory:OverlayChatWidgetV2.__CurrentGroup.TicketInputsMandatory;var e=(lz_session.OVLWMSElem=="chat")?OverlayChatWidgetV2.__CurrentGroup.ChatInputsHidden:OverlayChatWidgetV2.__CurrentGroup.TicketInputsHidden;var d=lz_is_placeholder_support();for(var f=0;f<LiveZillaData.InputFieldIndices.length;f++){var o=LiveZillaData.InputFieldIndices[f];if(o==115||(document.getElementById("files_"+o)==null&&LiveZillaData.InputFieldValues[f].Type=="File")){continue}if(LiveZillaData.InputFieldValues[f].Active||(o==116&&lz_session.OVLWMSElem=="phone")){try{if(LiveZillaData.InputFieldValues[f].Type=="File"){j=document.getElementById("files_"+o).children.length>0||lz_session.OVLWMSElem=="chat"}else{j=(LiveZillaData.InputFieldValues[f].Type=="CheckBox")?true:lz_chat_get_input_value(o).length>0}if(!d&&j&&LiveZillaData.InputFieldValues[f].Type!="CheckBox"&&lz_global_trim(document.getElementsByName("form_"+o)[0].value)==document.getElementById("lz_form_ph_"+o).value){j=false}}catch(k){}var m=(lz_array_indexOf(e,o)==-1&&(lz_array_indexOf(b,o)!=-1||LiveZillaData.InputFieldValues[f].Validation));if(o==112&&LiveZillaData.InputFieldValues[f].Value.length){if(LiveZillaData.InputFieldValues[f].Value.indexOf("@")==-1||LiveZillaData.InputFieldValues[f].Value.indexOf(".")==-1||LiveZillaData.InputFieldValues[f].Value.length<5){j=false}}if(m&&document.getElementById("lz_form_"+o).style.display=="none"){m=false}var a=(o==116&&lz_session.OVLWMSElem=="phone");var g=false;if(LiveZillaData.InputFieldValues[f].Validation&&!LiveZillaData.InputFieldValues[f].Validated&&lz_array_indexOf(e,LiveZillaData.InputFieldIndices[f])==-1){c=true}if((m||a||g)&&(!j)){if(h){document.getElementById("lz_form_mandatory_"+o).className="lz_input_icon lz_required";document.getElementById("lz_form_mandatory_"+o).style.display="block"}p=true}else{if(h){if(document.getElementById("lz_form_info_"+o).innerHTML.length>0){document.getElementById("lz_form_mandatory_"+o).className="lz_input_icon lz_info";document.getElementById("lz_form_mandatory_"+o).style.display="block"}else{document.getElementById("lz_form_mandatory_"+o).style.display="none"}}}}}if(OverlayChatWidgetV2.AcceptTOS){if(h){document.getElementById("lz_form_mandatory_tos").style.display="none"}if(!document.getElementById("lz_ccb_tos").checked){if(h){document.getElementById("lz_form_mandatory_tos").style.display="block"}p=true}}var n=LiveZillaData.Groups.GetGroupById(document.getElementById("lz_form_groups").value);document.getElementById("lz_form_mandatory_group").className="lz_input_icon lz_required";if(h){document.getElementById("lz_form_mandatory_group").style.display=(n==null)?"block":"none"}if(n==null){p=true}if(p&&!c){return false}else{if(!p&&l!=null){return lz_validate_inputs(l,e)}else{return !c&&!p}}}function lz_validate_inputs(c,a){var b;LiveZillaData.ValidationRequired=false;for(b=0;b<LiveZillaData.InputFieldValues.length;b++){LiveZillaData.InputFieldValues[b].SetStatus(null,false)}for(b=0;b<LiveZillaData.InputFieldValues.length;b++){if(LiveZillaData.InputFieldValues[b].Active){if(LiveZillaData.InputFieldValues[b].Validation&&!LiveZillaData.InputFieldValues[b].Validated&&lz_array_indexOf(a,LiveZillaData.InputFieldIndices[b])==-1){LiveZillaData.ValidationRequired=true;LiveZillaData.InputFieldValues[b].ValidationResult=null;lz_chat_loading(true);if(LiveZillaData.ValidationRequired&&LiveZillaData.InputFieldValues[b].ValidationURL.length>5){LiveZillaData.InputFieldValues[b].Validate(c);return false}}}}return true}function lz_validate_input_result(_result,_id){var failed=false;for(var i=0;i<LiveZillaData.InputFieldValues.length;i++){if(LiveZillaData.InputFieldValues[i].Index!=_id||LiveZillaData.InputFieldValues[i].Validated){continue}if(LiveZillaData.InputFieldValues[i].ValidationResult!=null){continue}var cinput=LiveZillaData.InputFieldValues[i];cinput.Validated=true;cinput.ValidationResult=_result;clearTimeout(cinput.ValidationTimeoutObject);if(_result===false){failed=true}else{if(_result===-1){if(cinput.ValidationContinueOnTimeout){cinput.ValidationResult=true;eval(cinput.ValidationContinueAt);return}else{failed=true}}else{if(_result===true){eval(cinput.ValidationContinueAt);return}}}if(failed){setTimeout(function(){lz_chat_loading(false)},500);setTimeout(function(){document.getElementById("lz_form_mandatory_"+cinput.Index.toString()).style.display=""},501);setTimeout(function(){document.getElementById("lz_form_mandatory_"+cinput.Index.toString()).className="lz_input_icon lz_required lz_anim_hs"},700);cinput.Validated=false;for(var x=0;x<LiveZillaData.InputFieldValues.length;x++){LiveZillaData.InputFieldValues[x].Validated=false}return}}}function lz_chat_scroll(){if(!lz_chat_scrolled){lz_chat_scrolled=true;OverlayChatWidgetV2.UpdateChatHistoryUI();OverlayChatWidgetV2.ScrollDown(47526)}}function lz_chat_pre_change_group(a){LiveZillaData.ForceSelectInit=true}function lz_chat_change_group(d){if(LiveZillaData.ForceGroupSelect&&!LiveZillaData.ForceSelectMade&&d.selectedIndex==d.childNodes.length-1){return}if(LiveZillaData.ForceGroupSelect&&LiveZillaData.ForceSelectInit&&!LiveZillaData.ForceSelectMade){LiveZillaData.ForceSelectMade=true;d.removeChild(LiveZillaData.Groups.ForceSelectOption);OverlayChatWidgetV2.UpdateFormUI()}var c=(OverlayChatWidgetV2.__CurrentGroup!=null)?OverlayChatWidgetV2.__CurrentGroup.Id+OverlayChatWidgetV2.__CurrentGroup.Amount:"";OverlayChatWidgetV2.__CurrentGroup=LiveZillaData.Groups.GetGroupById(d.value);if(OverlayChatWidgetV2.__CurrentGroup==null){var a=d.selectedIndex;var b=false;while(OverlayChatWidgetV2.__CurrentGroup==null){a++;if(a==d.childNodes.length){if(!b){a=0;b=true}else{break}}OverlayChatWidgetV2.__CurrentGroup=LiveZillaData.Groups.GetGroupById(d.childNodes[a].value)}}var e=(OverlayChatWidgetV2.__CurrentGroup!=null)?OverlayChatWidgetV2.__CurrentGroup.Id+OverlayChatWidgetV2.__CurrentGroup.Amount:"";if(OverlayChatWidgetV2.__CurrentGroup!=null){if(d.length>a){d.selectedIndex=a}if(c!=e){OverlayChatWidgetV2.UpdateUI()}d.style.color=d.childNodes[d.selectedIndex].style.color;d.style.background=d.childNodes[d.selectedIndex].style.background}OverlayChatWidgetV2.ValidateMode();OverlayChatWidgetV2.UpdateUI();OverlayChatWidgetV2.UpdateButtonUI();OverlayChatWidgetV2.UpdateWMUI();OverlayChatWidgetV2.SetGroupInfo()}function lz_chat_show_info_box(b,a){var d=b.id.replace("lz_form_mandatory_","");var c=document.getElementById("lz_form_info_"+d);c.style.display=(a&&c.style.display!="block")?"block":"none";if(lz_overlay_chat.m_FullScreenMode){c.style.marginLeft="34px"}else{c.style.right="30px"}}function lz_chat_switch_options(g,c,f,b){var d=[];if(!c){lz_chat_unset_focus();var h=document.getElementById("lz_chat_overlay_options_box").style.display=="none";for(var e=0;e<d.length;e++){document.getElementById("lz_chat_overlay_option_function_"+d[e]).style.display=(g==d[e])?"block":"none"}if(h){lz_chat_option_function=g;if(g=="fu"){var j=(f=="ticket")?"uid="+lz_global_base64_url_encode(lz_session.UserId)+"&bid="+lz_global_base64_url_encode(lz_session.BrowserId):"cid="+lz_global_base64_url_encode(OverlayChatWidgetV2.__CurrentChatId)+"&wt=ovlv2";if(typeof b!="undefined"){j+="&find="+lz_global_base64_url_encode(b)}if(OverlayChatWidgetV2.__CurrentGroup!=null){j+="&gid="+lz_global_base64_url_encode(OverlayChatWidgetV2.__CurrentGroup.Id)}j+="&etc="+lz_global_base64_url_encode(lz_color_primary);var a=lz_poll_server+"upload.php?"+j+"&ptl="+LiveZillaData.Language;if(document.getElementById("lz_chat_overlay_file_upload_frame").src!=a){document.getElementById("lz_chat_overlay_file_upload_frame").src=a}}}else{if(g=="fu"){lz_load_inputs=true;LiveZilla.Engine.Poll(1021)}lz_session.Save()}lz_mode_show_options=h;lz_chat_fade_options(h)}else{lz_chat_fade_options(false)}}function lz_chat_remove_att(a){OverlayChatWidgetV2.RemoveAttachmentId=a;LiveZilla.Engine.Poll(1412)}function lz_chat_load_input_values(a){for(var c=0;c<LiveZillaData.InputFieldIndices.length;c++){var b=LiveZillaData.InputFieldIndices[c];if(document.getElementById("lz_form_"+b)!=null){if(LiveZillaData.InputFieldValues[c].Type=="File"){continue}if(document.getElementsByName("form_"+b)[0].tagName.toUpperCase()=="SELECT"){document.getElementsByName("form_"+b)[0].selectedIndex=parseInt(LiveZillaData.InputFieldValues[c].Value)}else{if(document.getElementsByName("form_"+b)[0].type.toUpperCase()=="CHECKBOX"){if(document.getElementsByName("form_"+b)[0].value==""||a){document.getElementsByName("form_"+b)[0].value=LiveZillaData.InputFieldValues[c].Value}document.getElementsByName("form_"+b)[0].checked=(parseInt(LiveZillaData.InputFieldValues[c].Value)==1)}else{if(document.getElementsByName("form_"+b)[0].value==""||a){document.getElementsByName("form_"+b)[0].value=lz_global_trim(LiveZillaData.InputFieldValues[c].Value)}}}}}}function lz_chat_kb_deactivate(b,a){lz_chat_search_result(0);if(b){lz_session.KBS=0;lz_session.Save()}if(a){if(lz_chat_get_wm_element("knowledgebase")!=null&&!lz_kb_external){OverlayChatWidgetV2.SetMode("knowledgebase",true)}else{OverlayChatWidgetV2.Pop("knowledgebase","&eq="+lz_global_base64_encode(document.getElementsByName("form_114")[0].value))}}}function lz_chat_open(a){OverlayChatWidgetV2.Open(a)}function lz_chat_show(a){lz_chat_open(a)}function lz_chat_hide(){lz_session.OVLWMState="0";OverlayChatWidgetV2.SetMode(OverlayChatWidgetV2.GetAutoMode());if(OverlayChatWidgetV2.__ModeClassic){lz_overlay_chat.SetVisible(false)}}function lz_chat_overlay_set_mode(b,a){OverlayChatWidgetV2.SetMode(b,a)}function lz_chat_is_visible(){return lz_session.OVLWMState=="1"&&lz_session.OVLWMSElem!=""&&lz_session.OVLWMSElem!="wm"}function lz_chat_set_zoom(a,b){if(!lz_fixed_mode_possible()){return}if(b){lz_chat_restore_meta();lz_overlay_chat.SetVisible(false);lz_overlay_chat.SetFixedMode(true);lz_default_overflow=document.body.style.overflow;document.body.style.position="fixed";document.body.style.overflow="hidden";document.body.style.right=0;document.body.style.left=0;lz_chat_set_meta();setTimeout(function(){lz_chat_set_slide(a);lz_chat_update_css();OverlayChatWidgetV2.UpdateChatHistoryUI();OverlayChatWidgetV2.ScrollDown(51194)},500)}else{lz_overlay_chat.SetVisible(false);lz_chat_restore_meta();document.body.style.position="";document.body.style.overflow=lz_default_overflow;lz_overlay_chat.SetFixedMode(false);lz_chat_set_slide(false)}}function lz_chat_set_slide(a){if(a){lz_overlay_chat.m_FrameElement.style.transform="translateY(+100%)";lz_overlay_chat.m_FrameElement.style["-webkit-transform"]="translateY(+100%)";lz_overlay_chat.SetVisible(true);lz_overlay_chat.m_FrameElement.className="lz_anim_slide_in"}else{lz_overlay_chat.m_FrameElement.style.transform="";lz_overlay_chat.m_FrameElement.style["-webkit-transform"]="";lz_overlay_chat.m_FrameElement.className=""}}function lz_overlay_chat_impose_max_length(b,a){if(b.value.length>a){b.value=b.value.substring(0,a)}}function lz_chat_set_meta(){var b,a=document.getElementsByTagName("meta");if(a.length>0){for(b in a){if(a[b].name=="viewport"&&a[b].id!="lzvpc"){if(a[b].content!=null&&a[b].content.toLowerCase().indexOf("width=device-width")!=-1){return}lz_default_meta=a[b];a[b].parentNode.removeChild(a[b])}}}var c=document.createElement("meta");c.name="viewport";c.id="lzvpc";c.content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no";document.getElementsByTagName("head")[0].appendChild(c)}function lz_chat_restore_meta(){if(document.getElementById("lzvpc")!=null){document.getElementById("lzvpc").setAttribute("content","");document.getElementsByTagName("head")[0].removeChild(document.getElementById("lzvpc"))}if(lz_default_meta!=null){document.getElementsByTagName("head")[0].appendChild(lz_default_meta)}}function lz_chat_get_wm_element(a){for(var b=0;b<lz_ovlel.length;b++){if(lz_ovlel[b]!=null&&lz_ovlel[b].type==a){return lz_ovlel[b]}}return null}function lz_chat_play_sound(a){OverlayChatWidgetV2.PlaySound(a)}OverlayChatWidgetV2.StartChat=function(){if(lz_chat_status>0||(lz_chat_status==0&&lz_check_missing_inputs(true,"OverlayChatWidgetV2.StartChat"))){LiveZillaData.WriteToServer=true;lz_chat_loading(false);if(lz_chat_status==0){if(document.getElementsByName("form_114")[0].value.length){document.getElementById("lz_chat_text").value=document.getElementsByName("form_114")[0].value;OverlayChatWidgetV2.InputKeyUp({keyCode:13,ctrlKey:false})}else{if(!OverlayChatWidgetV2.__ModeBot){OverlayChatWidgetV2.InitChat()}}}OverlayChatWidgetV2.ChatStarted=true;OverlayChatWidgetV2.SetGroupInfo();OverlayChatWidgetV2.UpdateUI()}else{OverlayChatWidgetV2.UpdateUI();lz_chat_set_focus(8)}LiveZilla.Engine.Poll(1153,true)};OverlayChatWidgetV2.ReleasePost=function(b,c){for(var a=0;a<lz_external.MessagesSent.length;a++){if(lz_external.MessagesSent[a].MessageId==b){lz_external.MessagesSent[a].Received=true}}OverlayChatWidgetV2.UpdateChatHistoryUI(c)};OverlayChatWidgetV2.UpdateChatHistoryUI=function(m,l){var b,e,h,k,f,j=["lz_chat_content_box"];if(OverlayChatWidgetV2.PostPreview!=null){j.push("lz_overlay_preview")}for(h=0;h<j.length;h++){for(e=0;e<document.getElementById(j[h]).getElementsByTagName("span").length;e++){if(document.getElementById(j[h]).getElementsByTagName("span")[e].className=="lz_overlay_chat_message_time"){if(document.getElementById(j[h]).getElementsByTagName("span")[e].innerHTML.indexOf(":")==-1){if(!document.getElementById(j[h]).getElementsByTagName("span")[e].innerHTML.length&&lz_d(m)&&m!=null){document.getElementById(j[h]).getElementsByTagName("span")[e].innerHTML=m}document.getElementById(j[h]).getElementsByTagName("span")[e].innerHTML=lz_global_get_time(document.getElementById(j[h]).getElementsByTagName("span")[e].innerHTML)}}if(l){var a=document.getElementById(j[h]).getElementsByClassName("lz_overlay_chat_message_text");for(f=0;f<a.length-1;f++){b=a[f].getElementsByClassName("lz_chat_bot_button");for(k=0;k<b.length;k++){if(b[k].className.indexOf("keep_alive")==-1){lz_add_class(b[k],"lz_chat_disabled")}}}}}if(document.getElementById(j[h]).getElementsByClassName("lz_chat_queue_position")[0]){var d=parseInt(document.getElementById(j[h]).getElementsByClassName("lz_chat_queue_position")[0].innerHTML);var c=parseInt(document.getElementById(j[h]).getElementsByClassName("lz_chat_queue_waiting_time")[0].innerHTML);if(d==-1||(OverlayChatWidgetV2.QueuePosition>0&&OverlayChatWidgetV2.QueuePosition<=d)){document.getElementById(j[h]).getElementsByClassName("lz_chat_queue_position")[0].innerHTML=OverlayChatWidgetV2.QueuePosition.toString()}if(c==-1||(OverlayChatWidgetV2.QueueTime>0&&OverlayChatWidgetV2.QueueTime<=c)){document.getElementById(j[h]).getElementsByClassName("lz_chat_queue_waiting_time")[0].innerHTML=OverlayChatWidgetV2.QueueTime.toString()}}}var g=(lz_overlay_chat.m_FixedMode||lz_overlay_chat.m_FullScreenMode)?lz_global_get_window_width(true):lz_overlay_chat_width;if(document.getElementById("lz_chat_members_box").style.display=="block"){g-=200}for(e=0;e<document.getElementById("lz_chat_content_box").childNodes.length;e++){if(document.getElementById("lz_chat_content_box").childNodes[e].tagName.toLowerCase()=="div"){document.getElementById("lz_chat_content_box").childNodes[e].style.width=(lz_chat_scrolled||document.getElementById("lz_chat_content_box").scrollHeight>document.getElementById("lz_chat_content_box").clientHeight)?(g-16+"px"):(g-1+"px")}}};OverlayChatWidgetV2.UpdateWaitingPosts=function(d){if(lz_overlay_chat.m_FullScreenMode){if(!lz_chats_external){if(lz_overlay_wm!=null&&lz_chat_get_wm_element("chat")!=null){document.getElementById("livezilla_wm_c_chat").style.display=(lz_session.OVLCWM>0)?"table-cell":"none";document.getElementById("livezilla_wm_c_chat").innerHTML=lz_session.OVLCWM}else{if(document.getElementById("livezilla_c_chat")!=null){document.getElementById("livezilla_c_chat").style.display=(lz_session.OVLCWM>0&&lz_session.OVLWMState=="0")?"table-cell":"none";document.getElementById("livezilla_c_chat").innerHTML=lz_session.OVLCWM}}}else{if(document.getElementById("livezilla_c_chat")!=null){document.getElementById("livezilla_c_chat").style.display="none"}}}else{if(!lz_chats_external){if(OverlayChatWidgetV2.PostPreview==null){var e=lz_overlay_wm!=null?lz_overlay_wm.m_Margins:lz_overlay_chat.m_Margins;var a=lz_overlay_wm!=null?lz_overlay_wm.m_Height:45;var c=OverlayChatWidgetV2.__ModeClassic?260:lz_overlay_chat_width*0.7;OverlayChatWidgetV2.PostPreview=new lz_livebox_v2("lz_overlay_preview","",c,"auto",0,0,e[1],e[2]+a,"22");if(OverlayChatWidgetV2.Screenshot==null){OverlayChatWidgetV2.PostPreview.SetVisible(true)}OverlayChatWidgetV2.PostPreview.m_FrameElement.style.zIndex=lz_overlay_zindex;OverlayChatWidgetV2.PostPreview.m_FrameElement.onclick=function(){if(lz_overlay_wm!=null){OverlayChatWidgetV2.SetMode("wm",true)}if(!OverlayChatWidgetV2.__ModeSingle&&OverlayChatWidgetV2.IsChatAvailable()){OverlayChatWidgetV2.SetMode("chat",true)}if(OverlayChatWidgetV2.__ModeClassic){OverlayChatWidgetV2.Maximize()}};OverlayChatWidgetV2.ResetPreviewPosts()}var b=lz_session.OVLCWM>0||!OverlayChatWidgetV2.IsChatAvailable();if(lz_session.OVLWMState=="0"&&b&&d!=null&&d.length){if(OverlayChatWidgetV2.Screenshot==null){OverlayChatWidgetV2.PostPreview.SetVisible(true)}var f=document.createElement("div");f.innerHTML=d;document.getElementById("lz_overlay_preview_messages").appendChild(f);OverlayChatWidgetV2.EmbedTextControl(true)}else{if(lz_session.OVLCWM==0){OverlayChatWidgetV2.ResetPreviewPosts()}}}}};OverlayChatWidgetV2.EmbedTextControl=function(a){if(OverlayChatWidgetV2.PreviewTextControl!=a){var b=document.getElementById("lz_chat_overlay_bottom");if(a){document.getElementById("lz_overlay_preview_tctrl").appendChild(b)}else{document.getElementById("lz_overlay_module_chat").appendChild(b)}OverlayChatWidgetV2.PreviewTextControl=a}if(document.getElementById("lz_overlay_preview_tctrl")!=null){document.getElementById("lz_overlay_preview_tctrl").style.display=OverlayChatWidgetV2.IsChatAvailable()?"block":"none"}};OverlayChatWidgetV2.ResetPreviewPosts=function(a){if(a){lz_session.OVLCWM=0;lz_session.Save()}if(OverlayChatWidgetV2.PostPreview==null){return}if(!OverlayChatWidgetV2.PostPreview.m_FrameElement.innerHTML.length){OverlayChatWidgetV2.PostPreview.m_FrameElement.innerHTML=lz_get_icon("lz_wm_preview_close_icon","times-circle","OverlayChatWidgetV2.ResetPreviewPosts(true);OverlayChatWidgetV2.AnswerChatRequest(false,true);lz_stop_propagation(evt);","");OverlayChatWidgetV2.PostPreview.m_FrameElement.innerHTML+='<div id="lz_overlay_preview_messages"></div>';OverlayChatWidgetV2.PostPreview.m_FrameElement.innerHTML+='<div id="lz_overlay_preview_tctrl" onclick="if(event.stopPropagation){event.stopPropagation();}event.cancelBubble=true;" class="lz_preview_message"></div>'}else{document.getElementById("lz_overlay_preview_messages").innerHTML=""}OverlayChatWidgetV2.PostPreview.SetVisible(false);OverlayChatWidgetV2.EmbedTextControl(false)};OverlayChatWidgetV2.ReplaceEmoticons=function(d){if(OverlayChatWidgetV2.__CurrentGroup!=null&&OverlayChatWidgetV2.__CurrentGroup.ChatFunctions!=null&&OverlayChatWidgetV2.__CurrentGroup.ChatFunctions[0]=="0"){return d}var b=[/:-\)/g,/::smile/g,/:\)/g,/:-\(/g,/::sad/g,/:\(/g,/:-]/g,/::lol/g,/;-\)/g,/::wink/g,/;\)/g,/:'-\(/g,/::cry/g,/:-O/g,/::shocked/g,/:-\\\\/g,/::sick/g,/:-p/g,/::tongue/g,/:-P/g,/:\?/g,/::question/g,/8-\)/g,/::cool/g,/zzZZ/g,/::sleep/g,/:-\|/g,/::neutral/g];var a=["smile","smile","smile","sad","sad","sad","lol","lol","wink","wink","wink","cry","cry","shocked","shocked","sick","sick","tongue","tongue","tongue","question","question","cool","cool","sleep","sleep","neutral","neutral"];for(var c=0;c<b.length;c++){d=d.replace(b[c]," <img border=0 src='"+lz_poll_server+"images/smilies/"+a[c]+".gif'> ")}return d};OverlayChatWidgetV2.AddMessages=function(e,c,k,l,b){OverlayChatWidgetV2.__PostsNoticed=lz_is_mobile;if(!e.length){return}e=JSON.parse(lz_global_base64_decode(e));var f="",o="",h=["ONM01"];for(var d=0;d<e.length;d++){var m=1;var a=lz_global_get_window_width();for(var j=0;j<30;j++){if(a>160){m++;a=lz_global_get_window_width()/m}}var g=false;if(!lz_chat_full_load&&lz_session.OVLWMState=="0"){g=true;lz_session.OVLCWM++}else{if(lz_chat_full_load&&lz_session.OVLWMState=="0"&&lz_session.OVLCWM===0&&e.length===2){g=true;lz_session.OVLCWM++}else{if(!lz_chat_full_load&&lz_overlay_chat.m_FullScreenMode&&lz_session.OVLWMSElem!="chat"){lz_session.OVLCWM++}else{if(lz_session.OVLCWM>0&&d>=e.length-lz_session.OVLCWM){g=true}else{if(!OverlayChatWidgetV2.IsChatAvailable()){g=true;lz_session.OVLCWM++}else{if(e[d][3]==1&&!OverlayChatWidgetV2.IsChatActive()){g=true}}}}}}e[d][0]=lz_global_base64_decode(e[d][0]);e[d][0]=e[d][0].replace("<!--ifsc-->",1/m);e[d][0]=e[d][0].replace("<!--ifw-->",lz_global_get_window_width());e[d][0]=e[d][0].replace("<!--ifh-->",lz_global_get_window_height());e[d][0]=e[d][0].replace(/<!--fw-->/g,parseInt(lz_global_get_window_width()/m));e[d][0]=e[d][0].replace(/<!--fh-->/g,parseInt(lz_global_get_window_height()/m));f+=e[d][0];if(e[d][0].length&&g&&d>=e.length-lz_session.OVLCWM){if(h.indexOf(e[d][1])==-1){if(!(lz_d(e[d][2])&&e[d][2]==0)){if(e[d][3]==1){if(!OverlayChatWidgetV2.IsChatAvailable()&&e[d][4]==1){continue}if(OverlayChatWidgetV2.IsChatAvailable()&&e[d][4]==0){continue}}if(e[d][0].indexOf("<img")!==0){o+='<div class="lz_preview_message">'+OverlayChatWidgetV2.ReplaceEmoticons(e[d][0])+"</div>"}else{o+="<div>"+e[d][0]+"</div>"}}}}}lz_session.Save();OverlayChatWidgetV2.UpdateWaitingPosts(o);if(f!=null){if(lz_chat_full_load&&c){lz_chat_full_load=false}if(k!=null&&OverlayChatWidgetV2.__LastPostReceived!=lz_global_base64_decode(k)){OverlayChatWidgetV2.__LastPostReceived=lz_global_base64_decode(k);OverlayChatWidgetV2.__IsPostStatusUpdate=true}if(l!=null&&lz_chat_last_message_received!=lz_global_base64_decode(l)){lz_chat_last_message_received=lz_global_base64_decode(l)}if(b!=null&&f!=null&&lz_chat_last_poster!=lz_global_base64_decode(b)){lz_chat_last_poster=lz_global_base64_decode(b)}if(lz_chat_last_poster==lz_external.Id&&lz_mode_show_options){lz_chat_switch_options(lz_chat_option_function,false)}var n=document.createElement("div");document.getElementById("lz_chat_content_inlay").appendChild(n);n.innerHTML=OverlayChatWidgetV2.ReplaceEmoticons(f);OverlayChatWidgetV2.ScrollDown(37564);OverlayChatWidgetV2.UpdateChatHistoryUI();lz_chat_replace_icon();if(lz_operator_typing){document.getElementById("lz_chat_content_inlay").appendChild(document.getElementById("lz_chat_overlay_typing_post"))}}OverlayChatWidgetV2.UpdateChatHistoryUI(null,true)};OverlayChatWidgetV2.ShowQueueMessage=function(a,c,b){OverlayChatWidgetV2.QueueTime=c;OverlayChatWidgetV2.QueuePosition=a;if(!LiveZillaData.QueueMessageAppended){var d=lz_global_base64_decode(b).replace("<!--queue_position-->","<span class='lz_chat_queue_position' style='color:"+lz_color_secondary+"'>-1</span>");d=d.replace("<!--queue_waiting_time-->","<span class='lz_chat_queue_waiting_time' style='color:"+lz_color_secondary+"'>-1</span>");OverlayChatWidgetV2.AddMessages(lz_global_base64_encode(JSON.stringify([[lz_global_base64_encode(d),"MP",1]])),false,null,null,null);LiveZillaData.QueueMessageAppended=true;lz_chat_last_poster=null}OverlayChatWidgetV2.UpdateChatHistoryUI()};OverlayChatWidgetV2.AddWMElements=function(d,k,g,j,p,n){if(!OverlayChatWidgetV2.__ModeSingle&&!OverlayChatWidgetV2.__ModeClassic&&!n){for(var m=0;m<lz_ovlel.length;m++){if(lz_ovlel[m].type=="chat"&&lz_d(lz_ovlel[m].hcwo)){lz_ovlel.splice(m,1);break}}}if(lz_ovlel.length==1){return}var e=OverlayChatWidgetV2.__SizeWidth;if(OverlayChatWidgetV2.__ModeTextInline){OverlayChatWidgetV2.__SizeWidth=OverlayChatWidgetV2.GetWMWidth()}if(lz_overlay_wm==null&&!OverlayChatWidgetV2.__ModeCombi){var s=(lz_ovlel_fsm)?"auto":OverlayChatWidgetV2.__SizeWidth+OverlayChatWidgetV2.__Border;var r=(lz_ovlel_fsm)?Math.floor(48*OverlayChatWidgetV2.__Ratio):(OverlayChatWidgetV2.__SizeHeight+OverlayChatWidgetV2.__Border)+OverlayChatWidgetV2.__Space;var b=(lz_ovlel_fsm)?"00":"22";lz_overlay_wm=new lz_livebox_v2("lz_overlay_wm",d,s,r,k,0,j,p,b,(lz_ovlel_fsm)?document.getElementById("lz_chat_fs_body"):document.body);lz_overlay_wm.m_MaxHeight=(lz_ovlel_fsm)?r+"px":((OverlayChatWidgetV2.__SizeHeight+OverlayChatWidgetV2.__Border)+OverlayChatWidgetV2.__Space)*lz_ovlel.length;lz_overlay_wm.SetMobile(lz_is_mobile);lz_chat_overlay_pointer=document.getElementById("lz_chat_overlay_pointer_"+((OverlayChatWidgetV2.__ModeSingle)?"v":"h"));if(lz_ovlel_fsm){lz_overlay_wm.m_FrameElement.style.whiteSpace="nowrap";lz_overlay_wm.m_FrameElement.style.overflow="hidden";lz_overlay_wm.m_FrameElement.style.background="#f7f8f9";lz_overlay_wm.m_FrameElement.style.position="absolute"}var t,q,h,v,z,f=document.getElementById("livezilla_wm"),u=document.getElementById("livezilla_wm_d"),w=document.getElementById("livezilla_wm_c");f.style.height=OverlayChatWidgetV2.__SizeHeight+"px";f.style.width=OverlayChatWidgetV2.__SizeWidth+"px";var o=lz_overlay_zindex+100;if(lz_is_mobile&&!lz_ovlel_fsm){o-=1000}var A=Math.floor(10*OverlayChatWidgetV2.__Ratio);for(var l=lz_ovlel.length-1;l>=0;l--){t=(lz_ovlel_fsm)?((lz_ovlel.length-1)-l):l;if(lz_ovlel[t]==null){continue}q=(((OverlayChatWidgetV2.__SizeHeight+OverlayChatWidgetV2.__Border)*t)+(OverlayChatWidgetV2.__Space*t));v=null;if(lz_ovlel[t].type!="wm"){h=f.cloneNode(true);OverlayChatWidgetV2.ApplyIconToElement(h,lz_ovlel[t].icon);h.id+="_"+lz_ovlel[t].type;h.style.zIndex=o-t;lz_overlay_wm.m_FrameElement.appendChild(h);v=u.cloneNode(true);v.id+="_"+lz_ovlel[t].type;if(OverlayChatWidgetV2.__ModeTextInline){v.style.boxShadow="none"}v.innerHTML=OverlayChatWidgetV2.GetElementTitle(lz_ovlel[t]);var a=41;if(OverlayChatWidgetV2.__Ratio==0.8){a=38}if(!lz_ovlel_fsm&&!OverlayChatWidgetV2.__ModeTextInline){v.style.right=OverlayChatWidgetV2.__SizeWidth+"px";v.style.boxShadow="none"}if(OverlayChatWidgetV2.__ModeTextInline){u.style.marginLeft=v.style.marginLeft=(OverlayChatWidgetV2.__SizeHeight-(OverlayChatWidgetV2.__Ratio*5))+"px";u.style.cursor=v.style.cursor="pointer";u.style.display=v.style.display="block";u.style.background=v.style.background="none";u.style.width=v.style.width=(OverlayChatWidgetV2.__SizeWidth-(OverlayChatWidgetV2.__Ratio*68))+"px";u.style.textOverflow=v.style.textOverflow="ellipsis";u.style.overflow=v.style.overflow="hidden";u.innerHTML=OverlayChatWidgetV2.ButtonTexts[lz_ovlel[t].type];u.style.marginTop=v.style.marginTop="-"+OverlayChatWidgetV2.__SizeHeight+"px";u.style.fontSize=v.style.fontSize=OverlayChatWidgetV2.__Ratio*115+"%";u.style.lineHeight=v.style.lineHeight=OverlayChatWidgetV2.__SizeHeight+"px";v.style.borderRadius=lz_border_radius+"px";if(typeof lz_ovlel[t].color=="undefined"){h.style.background="linear-gradient(to right, "+lz_color_secondary+" 0%,"+lz_color_secondary+" "+e+"px,"+lz_color_secondary+" "+e+"px,"+lz_color_primary+" "+e+"px,"+lz_color_primary+" 100%)"}}else{u.style.marginTop=v.style.marginTop="-"+(OverlayChatWidgetV2.__SizeHeight)+"px";u.style.fontSize=v.style.fontSize=OverlayChatWidgetV2.__Ratio*100+"%";u.style.lineHeight=v.style.lineHeight=(OverlayChatWidgetV2.__SizeHeight)+"px";u.style.width=v.style.width=OverlayChatWidgetV2.GetWMWidth(lz_ovlel[t])+"px";v.style.borderRadius=lz_border_radius+"px 0 0 "+lz_border_radius+"px"}if(lz_is_mobile&&!lz_ovlel_fsm){v.style.opacity=0}v.style.zIndex=h.style.zIndex;h.setAttribute("data-did",v.id);h.setAttribute("data-type",lz_ovlel[t].type);if(!lz_ovlel_fsm){h.appendChild(v)}else{lz_overlay_wm.m_FrameElement.appendChild(v)}if(typeof lz_ovlel[t].counter!="undefined"){z=w.cloneNode(true);z.id+="_"+lz_ovlel[t].type;z.style.zIndex=h.style.zIndex+2;h.appendChild(z);if(lz_ovlel_fsm){z.style.top="-45px";z.style.left="55px"}}if(!lz_ovlel_fsm){h.style.top=(Math.max(46,OverlayChatWidgetV2.__SizeHeight+OverlayChatWidgetV2.__Border)*-1)+"px"}else{h.style.top=parseInt((r-(OverlayChatWidgetV2.__SizeHeight+OverlayChatWidgetV2.__Border))/2)+"px";if(typeof lz_ovlel[t].href=="undefined"){h.style.left=((OverlayChatWidgetV2.__SizeWidth+OverlayChatWidgetV2.__Border+A)*(t))-(OverlayChatWidgetV2.__SizeWidth/1.3)+"px"}else{h.style.right="-1000px"}}if(!lz_ovlel_fsm&&typeof lz_ovlel[t].margin!="undefined"){h.style.marginBottom=lz_ovlel[t].margin[2]+OverlayChatWidgetV2.__Space+"px";lz_overlay_wm.m_MaxHeight+=lz_ovlel[t].margin[2]}else{if(!lz_ovlel_fsm){h.style.marginBottom=OverlayChatWidgetV2.__Space+"px"}}if(lz_ovlel[t].type=="phone"){lz_mode_phone_outbound=lz_ovlel[t].outbound!=false;lz_mode_phone_inbound=lz_ovlel[t].inbound!=false;if(lz_mode_phone_inbound){var c=lz_global_base64_url_decode(lz_ovlel[t].inbound.number);document.getElementById("lz_chat_data_phone_header_number").innerHTML=c;document.getElementById("lz_chat_data_phone_header_number").href="tel:"+c;document.getElementById("lz_chat_data_phone_header_text").innerHTML=lz_global_base64_url_decode(lz_ovlel[t].inbound.text)}}if(!lz_ovlel_fsm&&typeof lz_ovlel[t].color!="undefined"){h.style.backgroundColor=lz_ovlel[t].color;if(!OverlayChatWidgetV2.__ModeTextInline){v.style.backgroundColor=lz_ovlel[t].color}}else{if(!lz_ovlel_fsm){h.style.borderColor=lz_color_primary_dark}}}else{h=f;h.style.zIndex=o+100;if(!lz_ovlel_fsm){h.style.borderColor=lz_color_primary_dark}if(OverlayChatWidgetV2.__ModeTextInline){h.style.background="linear-gradient(to right, "+lz_color_secondary+" 0%,"+lz_color_secondary+" "+e+"px,"+lz_color_secondary+" "+e+"px,"+lz_color_primary+" "+e+"px,"+lz_color_primary+" 100%)"}}h.setAttribute("data-tid",lz_ovlel[t].type);if(!lz_ovlel_fsm){h.style.transform="translateY("+q+"px)";h.style.right=0}else{h.style.boxShadow="none";h.style.width="100px";h.style.textAlign="center"}h.style.borderRadius=OverlayChatWidgetV2.GetWMElementBorderRadius(false);h.style.position=(lz_ovlel_fsm)?"static":"relative";h.style.display=(lz_ovlel_fsm)?"inline-block":"block"}if(OverlayChatWidgetV2.__ModeTextInline){f.appendChild(u)}if(lz_ovlel.length){OverlayChatWidgetV2.ApplyIconToElement(f,lz_ovlel[0].icon)}if(!lz_ovlel_fsm){lz_chat_overlay_pointer.style.right=((!OverlayChatWidgetV2.__ModeSingle)?(Math.ceil(lz_overlay_chat.m_FrameElement.style.marginRight.replace("px",""))-12):(j+(((OverlayChatWidgetV2.__SizeWidth+OverlayChatWidgetV2.__Border)/2)-12)))+"px"}lz_chat_overlay_pointer.style.zIndex=o+1200;lz_overlay_wm.m_FrameElement.style.zIndex=lz_overlay_zindex}};OverlayChatWidgetV2.GetWMElementBorderRadius=function(a){var d=Math.floor(10*OverlayChatWidgetV2.__Ratio);var b;if(!lz_ovlel_fsm){var c=Math.min(50,lz_border_radius*d);if(!OverlayChatWidgetV2.__ModeTextInline){if(!a){b=c+"%"}else{b="0 "+c+"% "+c+"% 0"}}else{b=lz_border_radius+"px"}}else{b=0}return b};OverlayChatWidgetV2.GetWMWidth=function(g){var e,j,c=0;if(g){c=OverlayChatWidgetV2.GetElementTitle(g).length}else{for(var h=lz_ovlel.length-1;h>=0;h--){e=(lz_ovlel_fsm)?((lz_ovlel.length-1)-h):h;j=OverlayChatWidgetV2.GetElementTitle(lz_ovlel[e]);c=Math.max(c,j.length)}if(typeof lz_ovlel_rt_onl!="undefined"){c=Math.max(c,lz_ovlel_rt_onl.length)}if(typeof lz_ovlel_rt_ofl!="undefined"){c=Math.max(c,lz_ovlel_rt_ofl.length)}}var a=(!lz_is_mobile)?200:150;if(!OverlayChatWidgetV2.__ModeTextInline){a=(!lz_is_mobile)?300:150}var b=((OverlayChatWidgetV2.__ModeTextInline)?77:1)*OverlayChatWidgetV2.__Ratio;var f=9*OverlayChatWidgetV2.__Ratio;var d=b+(c*f);return Math.max(Math.min(d,a),70)};OverlayChatWidgetV2.GetElementTitle=function(a){var b="";if(a.type!="phone"){if(lz_d(OverlayChatWidgetV2.ButtonTexts[a.type])){b=OverlayChatWidgetV2.ButtonTexts[a.type]}else{if(lz_d(a.title)){b=lz_global_base64_url_decode(a.title)}}}else{b="";if(a.inbound!=false&&a.outbound!=false){b=lz_text_phone}else{if(a.inbound!=false){b+=OverlayChatWidgetV2.ButtonTexts.phone_in}if(a.outbound!=false){b+=OverlayChatWidgetV2.ButtonTexts.phone_out}}}return b};OverlayChatWidgetV2.PlaySound=function(a){if(lz_session.OVLCSound==1){if(lz_sound_player==null){var b=a.toLowerCase().indexOf("http")===0?a:lz_poll_server+"sound/"+a+".mp3";lz_sound_player=new Audio(b)}lz_sound_player.play();if(OverlayChatWidgetV2.__ModeAPI){lz_chat_open()}}};OverlayChatWidgetV2.SendMessage=function(e,a,h,c){OverlayChatWidgetV2.UpdateChatHistoryUI(null,true);if(!LiveZillaData.WriteToServer&&lz_chat_status==0){LiveZillaData.WriteToServer=true}var d=(e==null)?lz_global_trim(document.getElementById("lz_chat_text").value):e;if(d.length>0&&OverlayChatWidgetV2.__ModeBot){OverlayChatWidgetV2.InputState(true)}var i=(lz_session.TransInto!=""&&lz_session.TransInto!=null)?lz_session.TransInto:"";if(lz_tr_api_key!=""&&i!=""&&lz_session.TransFrom!=null&&lz_session.TransFrom!=""&&lz_session.TransFrom.toUpperCase()!=i.toUpperCase()&&e==null){var k=document.createElement("script");k.type="text/javascript";OverlayChatWidgetV2.DoneTranslateCallback=function b(n){if(OverlayChatWidgetV2.TranslateErrorTimer!=null){clearTimeout(OverlayChatWidgetV2.TranslateErrorTimer)}if(n.data!=null){OverlayChatWidgetV2.SendMessage(d,n.data.translations[0].translatedText);OverlayChatWidgetV2.DoneTranslateCallback=null}else{console.log("Sorry, there was an error while trying to translate:\r\n"+JSON.stringify(n));OverlayChatWidgetV2.SendMessage(d,null)}};var m=(lz_session.TransFrom!="AUTO")?"&source="+lz_session.TransFrom:"";k.src="https://www.googleapis.com/language/translate/v2?key="+lz_global_base64_decode(lz_tr_api_key)+"&format=html"+m+"&target="+i+"&callback=OverlayChatWidgetV2.DoneTranslateCallback&q="+d;OverlayChatWidgetV2.TranslateErrorTimer=setTimeout(function(){OverlayChatWidgetV2.DoneTranslateCallback({date:null})},5000);document.getElementsByTagName("head")[0].appendChild(k);document.getElementById("lz_chat_text").value="";return false}if(d.length>0){if(document.getElementsByClassName("lz_overlay_chat_message_invite").length&&lz_chat_status==0){OverlayChatWidgetV2.AnswerChatRequest(true,true);if(d.length>document.getElementsByName("form_114")[0].value.length){document.getElementsByName("form_114")[0].value=d}}var g="";var l=new lz_chat_post();if(a!=null){l.MessageTranslationText=a;g=lz_global_htmlentities(l.MessageTranslationText)+"<div class='lz_overlay_translation'>"+lz_global_htmlentities(d)+"</div>"}else{if(!h){g=lz_global_htmlentities(d)}else{g=d}}l.MessageText=d;l.MessageId=lz_global_microstamp();l.MessageTime=lz_global_timestamp();if(!h){lz_external.MessagesSent[lz_external.MessagesSent.length]=l}document.getElementById("lz_chat_text").value="";if(OverlayChatWidgetV2.CurrentOperator==null&&!OverlayChatWidgetV2.__PublicGroupChat.length){OverlayChatWidgetV2.SetConnectionState(true,null,null)}var j=(lz_chat_last_poster!=lz_external.Id)?lz_global_base64_decode(lz_post_html):lz_global_base64_decode(lz_add_html);var f=(lz_chat_get_input_value(111).length==0)?lz_guest_name:lz_chat_get_input_value(111);j=j.replace("<!--message-->",g);j=j.replace("<!--server-->",lz_poll_server);j=j.replace("<!--ename-->",lz_global_base64_url_encode(f));j=j.replace("<!--time-->","");j=j.replace("<!--name-->",lz_global_htmlentities(f));j=j.replace(/<!--my-->/g,1);j=j.replace("<!--bgce-->",lz_global_base64_url_encode(lz_color_primary));lz_chat_switch_extern_typing(false);if(!c){OverlayChatWidgetV2.AddMessages(lz_global_base64_encode(JSON.stringify([[lz_global_base64_encode(j),"MP"]])),false,null,null,lz_global_base64_encode(lz_external.Id))}if(!h){LiveZilla.Engine.Poll(1114,true)}lz_chat_set_focus(6)}OverlayChatWidgetV2.InputKeyUp(null);return false};OverlayChatWidgetV2.SetChat=function(a){if(!lz_d(a)){return}OverlayChatWidgetV2.__CurrentChatId=a;if(OverlayChatWidgetV2.__CurrentChatId!=0){OverlayChatWidgetV2.__LastChatId=OverlayChatWidgetV2.__CurrentChatId}if(OverlayChatWidgetV2.ScreenCaptureToStartChat){OverlayChatWidgetV2.ScreenCaptureToStartChat=false;OverlayChatWidgetV2.CaptureScreen(false,0)}else{if(OverlayChatWidgetV2.FileUploadToStartChat!=false){OverlayChatWidgetV2.UploadFile(OverlayChatWidgetV2.FileUploadToStartChat)}}};OverlayChatWidgetV2.SetHost=function(c,a,b,h,f,g,e,d){if(lz_overlay_chat!=null){OverlayChatWidgetV2.__ModeBot=a;if(g!=null&&lz_session.TransInto==""){g=lz_global_base64_decode(g);if(g.indexOf(",")!==-1){g=g.split(",")[0]}lz_session.TransInto=g;lz_session.Save()}if(c!=null){OverlayChatWidgetV2.CurrentOperator=new lz_chat_operator();OverlayChatWidgetV2.CurrentOperator.Id=lz_global_base64_decode(c);OverlayChatWidgetV2.CurrentOperator.Group=lz_global_base64_decode(b);OverlayChatWidgetV2.CurrentOperator.Fullname=lz_global_base64_decode(d);document.getElementById("lz_ccb_tos").checked=true}else{OverlayChatWidgetV2.TargetOperatorId=null;lz_external.MessagesSent=[];OverlayChatWidgetV2.CurrentOperator=null}OverlayChatWidgetV2.UpdateChatFunctions()}};OverlayChatWidgetV2.UpdateFormUI=function(){try{if(LiveZillaData.InputFieldIndices!=null&&OverlayChatWidgetV2.__CurrentGroup!=null){if(lz_first_call){lz_chat_loading(false);lz_first_call=false}var b=false;var h=(lz_session.OVLWMSElem=="chat");var f=(h)?OverlayChatWidgetV2.__CurrentGroup.ChatInputsHidden:OverlayChatWidgetV2.__CurrentGroup.TicketInputsHidden;var d=(h)?OverlayChatWidgetV2.__CurrentGroup.ChatInputsMandatory:OverlayChatWidgetV2.__CurrentGroup.TicketInputsMandatory;var e=lz_is_placeholder_support();for(var g=0;g<LiveZillaData.InputFieldIndices.length;g++){var m=LiveZillaData.InputFieldIndices[g];try{if(document.getElementById("lz_form_active_"+m)==null){continue}if(document.getElementById("lz_form_active_"+m).value=="true"||(lz_session.OVLWMSElem=="phone"&&m==116)){b=((lz_array_indexOf(f,m)>-1)||(LiveZillaData.ForceGroupSelect&&!LiveZillaData.ForceSelectMade&&LiveZillaData.InputFieldValues[g].IsHiddenGeneral(LiveZillaData.Groups.Groups,h)));if(OverlayChatWidgetV2.__PublicGroupChat.length&&m==114){b=true}if(h&&OverlayChatWidgetV2.__ModeChangeDetails&&m==114){b=true}if(h&&LiveZillaData.InputFieldValues[g].Type=="File"){b=true}if(lz_session.OVLWMSElem=="phone"&&m==116){b=false}if(m==115){b=true}if(lz_session.OVLWMSElem=="chat"&&!OverlayChatWidgetV2.IsChatAvailable()){b=true}document.getElementById("lz_form_"+m).className=(m==116&&lz_session.OVLWMSElem=="phone")?"lz_input lz_input_com":document.getElementById("lz_form_"+m).className;document.getElementById("lz_form_"+m).style.display=(b)?"none":"";document.getElementById("lz_form_"+m).style.display=(m==116&&lz_session.OVLWMSElem=="phone")?"":document.getElementById("lz_form_"+m).style.display;if(document.getElementById("lz_form_info_"+m).innerHTML.length>0&&!OverlayChatWidgetV2.__ModeChangeDetails){if(document.getElementById("lz_form_mandatory_"+m).className.indexOf("lz_required")==-1){document.getElementById("lz_form_mandatory_"+m).className="lz_input_icon lz_info"}document.getElementById("lz_form_mandatory_"+m).style.cursor="pointer";document.getElementById("lz_form_mandatory_"+m).style.display="";document.getElementById("lz_form_mandatory_"+m).onmouseover=function(){lz_chat_show_info_box(this,true)};document.getElementById("lz_form_mandatory_"+m).onmouseout=function(){lz_chat_show_info_box(this,false)};document.getElementById("lz_form_mandatory_"+m).onclick=function(){lz_chat_show_info_box(this,true)};document.getElementById("lz_form_info_"+m).onclick=function(){lz_chat_show_info_box(this,false)}}else{if(OverlayChatWidgetV2.__ModeChangeDetails){document.getElementById("lz_form_mandatory_"+m).style.display="none"}}if(document.getElementsByName("form_"+m)[0]!=null){document.getElementsByName("form_"+m)[0].disabled=OverlayChatWidgetV2.__ModeChangeDetails&&LiveZillaData.InputFieldValues[g].Validation}}else{document.getElementById("lz_form_"+m).style.display="none"}if(LiveZillaData.InputFieldValues[g].Active){if(lz_array_indexOf(d,m)!=-1||(LiveZillaData.InputFieldValues[g].Validation&&lz_array_indexOf(f,m)==-1)){if(!lz_mode_chat_login){lz_mode_chat_login=lz_chat_human_available&&!OverlayChatWidgetV2.__ModeBot}}if(!e&&(LiveZillaData.InputFieldValues[g].Type=="Text"||LiveZillaData.InputFieldValues[g].Type=="TextArea")){if(document.getElementsByName("form_"+m)[0].value==""){document.getElementsByName("form_"+m)[0].value=document.getElementById("lz_form_ph_"+m).value;document.getElementsByName("form_"+m)[0].style.color="var(--lz-icon-color)"}document.getElementsByName("form_"+m)[0].onfocus=new Function("if (this.value == '"+document.getElementById("lz_form_ph_"+m).value+"') {this.value = ''; this.style.color='#333'}");document.getElementsByName("form_"+m)[0].onblur=new Function("if (this.value == '') {this.value = '"+document.getElementById("lz_form_ph_"+m).value+"'; this.style.color='var(--lz-icon-color)'}")}if(LiveZillaData.InputFieldValues[g].Type=="File"){document.getElementById("files_"+m).style.display="none";document.getElementById("files_"+m).innerHTML="";document.getElementsByName("form_sc_"+m)[0].style.display=LiveZillaData.InputFieldValues[g].ScreenCapture&&!lz_overlay_chat.m_FullScreenMode?"inline":"none";if(LiveZillaData.InputFieldFiles[g].length){document.getElementById("files_"+m).style.display="block";for(var l=0;l<LiveZillaData.InputFieldFiles[g].length;l++){var k=lz_global_base64_decode(LiveZillaData.InputFieldFiles[g][l][1]);if(k=="screenshot.lzsc"){k="Screenshot"}document.getElementById("files_"+m).innerHTML+='<div class="lz_form_file_box"><span onclick="if(event.stopPropagation){event.stopPropagation();}event.cancelBubble=true;" class="lz_form_file_item">'+lz_global_htmlentities(k.substring(0,30))+"</span><span onclick=\"lz_chat_remove_att('"+LiveZillaData.InputFieldFiles[g][l][0]+'\');if(event.stopPropagation){event.stopPropagation();}event.cancelBubble=true;" class="lz_form_file_item lz_form_file_remove">X</span><div>'}}}}}catch(j){console.log(j)}}OverlayChatWidgetV2.AcceptTOS=false;if(OverlayChatWidgetV2.__CurrentGroup!=null){var c="";if(lz_session.OVLWMSElem=="ticket"&&OverlayChatWidgetV2.__CurrentGroup.TOSTicket.length){c=OverlayChatWidgetV2.__CurrentGroup.TOSTicket}if(lz_session.OVLWMSElem=="chat"&&OverlayChatWidgetV2.__CurrentGroup.TOSChat.length){c=OverlayChatWidgetV2.__CurrentGroup.TOSChat}if(lz_session.OVLWMSElem=="phone"&&OverlayChatWidgetV2.__CurrentGroup.TOSCallback.length){c=OverlayChatWidgetV2.__CurrentGroup.TOSCallback}if(c.length){OverlayChatWidgetV2.AcceptTOS=true;if(c.toLowerCase().indexOf("http")===0){document.getElementById("lz_chat_tos_text").innerHTML=document.getElementById("lz_chat_tos_text").innerHTML.replace("<a>",'<u><a href="'+c+'" target="_blank">').replace("</a>","</u></a>")}else{document.getElementById("lz_chat_tos_text_box").innerHTML=c;document.getElementById("lz_chat_tos_text").innerHTML=document.getElementById("lz_chat_tos_text").innerHTML.replace("<a>",'<u onclick="OverlayChatWidgetV2.ToggleTOS(true);">').replace("</a>","</u>")}}}document.getElementById("lz_form_tos").style.display=(lz_session.OVLWMSElem!="chat"||OverlayChatWidgetV2.IsChatAvailable())&&OverlayChatWidgetV2.AcceptTOS&&!OverlayChatWidgetV2.__ModeChangeDetails?"table":"none";var a=!OverlayChatWidgetV2.ForceGroupSelect&&((lz_session.OVLWMSElem=="chat"&&(OverlayChatWidgetV2.__ModeChangeDetails||lz_hide_group_chat))||((lz_session.OVLWMSElem=="ticket"||lz_session.OVLWMSElem=="phone")&&lz_hide_group_ticket));if(lz_session.OVLWMSElem=="chat"&&!OverlayChatWidgetV2.IsChatAvailable()){a=true}document.getElementById("lz_group_selection_box").style.display=a?"none":""}else{if(lz_first_call){lz_chat_loading(true)}}if(!lz_mode_chat_login&&OverlayChatWidgetV2.ForceGroupSelect){lz_mode_chat_login=true}}catch(j){console.log(j)}};OverlayChatWidgetV2.InputState=function(b,a){if(lz_d(a)){OverlayChatWidgetV2.InputBlocked=a}document.getElementById("lz_chat_text").style.display=(OverlayChatWidgetV2.InputBlocked||b)?"none":"block";document.getElementById("lz_chat_bot_reply_loading").style.display=(!b)?"none":"block";if(OverlayChatWidgetV2.__ModeBot&&!OverlayChatWidgetV2.InputBlocked&&!b){setTimeout(function(){lz_chat_set_focus(11)},200)}};OverlayChatWidgetV2.UpdateWMUI=function(){if(lz_overlay_wm==null){return}var j,b,a,h=document.getElementById("livezilla_wm");lz_overlay_wm.m_FrameElement.style.height=((lz_session.OVLWMState=="0")?(OverlayChatWidgetV2.__SizeHeight+OverlayChatWidgetV2.__Border):lz_overlay_wm.m_MaxHeight)+"px";for(var c=lz_ovlel.length-1;c>=0;c--){if(lz_ovlel[c]==null){continue}if(lz_ovlel[c].type!="wm"){b=document.getElementById("livezilla_wm_"+lz_ovlel[c].type);b.style.display=(lz_session.OVLWMState=="0"||OverlayChatWidgetV2.__ModeSingle)?"none":(!lz_overlay_chat.m_FullScreenMode)?"block":"inline-block";if(lz_session.OVLWMSElem==lz_ovlel[c].type){if(lz_overlay_chat.m_FullScreenMode){lz_chat_overlay_pointer.style.left=((((OverlayChatWidgetV2.__SizeWidth+OverlayChatWidgetV2.__Border)*(c))+13)+(c*10))-(OverlayChatWidgetV2.__SizeWidth/1.3)+"px";b.style.background=lz_color_primary;b.getElementsByTagName("svg")[0].style.fill="#fff"}else{if(!OverlayChatWidgetV2.__ModeSingle){var k=(((OverlayChatWidgetV2.__SizeHeight+OverlayChatWidgetV2.__Border)*c)+(OverlayChatWidgetV2.__Space*c))+OverlayChatWidgetV2.__Space+(14*OverlayChatWidgetV2.__Ratio);lz_chat_overlay_pointer.style.bottom=k+lz_overlay_wm.m_Margins[2]+"px";if(!OverlayChatWidgetV2.__ModeTextInline&&lz_ovlel[c].type.indexOf("custom")===-1){b.style.background="var(--sc-color)"}}}}else{if(lz_overlay_chat.m_FullScreenMode){b.style.background="#f7f8f9";b.style.borderRight="1px solid #ddd";b.getElementsByTagName("svg")[0].style.fill="#999"}else{if(!OverlayChatWidgetV2.__ModeTextInline&&lz_ovlel[c].type.indexOf("custom")===-1){b.style.background="var(--pc-color)"}}}j="livezilla_wm_d_"+lz_ovlel[c].type;a=document.getElementById(j);if(!lz_is_mobile&&!lz_overlay_chat.m_FullScreenMode){if(!lz_ie()){b.onmouseover=function(){if(this.getAttribute("data-tid")==lz_session.OVLWMSElem){if(!OverlayChatWidgetV2.__ModeTextInline){lz_chat_overlay_pointer.style.visibility="hidden"}}if(!OverlayChatWidgetV2.__ModeTextInline){if(this.getAttribute("data-did").indexOf("custom")===-1){this.style.background="var(--sc-color)";document.getElementById(this.getAttribute("data-did")).style.background="var(--sc-color)"}}document.getElementById(this.getAttribute("data-did")).style.display="block";var i=this;this.style.borderRadius=OverlayChatWidgetV2.GetWMElementBorderRadius(true);if(lz_is_mobile){setTimeout(function(){document.getElementById(i.getAttribute("data-did")).style.display="none"},2000)}}}b.onmouseout=function(){lz_chat_overlay_pointer.style.visibility="visible";if(!OverlayChatWidgetV2.__ModeTextInline){document.getElementById(this.getAttribute("data-did")).style.display="none";if(this.getAttribute("data-did").indexOf("custom")===-1){this.style.background=(this.getAttribute("data-tid")==lz_session.OVLWMSElem)?"var(--sc-color)":"var(--pc-color)"}}this.style.borderRadius=OverlayChatWidgetV2.GetWMElementBorderRadius(false)}}else{if(!lz_overlay_chat.m_FullScreenMode){a.style.display=(lz_is_mobile&&lz_session.OVLWMState=="0")?"none":"block";lz_add_class(a,"lz_anim_slide_in")}}lz_add_class(a,"lz_overlay_wm_sh_act")}else{b=h;b.style.top=(lz_session.OVLWMState!="0")?lz_overlay_wm.m_MaxHeight-((OverlayChatWidgetV2.__SizeHeight+OverlayChatWidgetV2.__Border)+OverlayChatWidgetV2.__Space)+"px":0;b.style.visibility=(!lz_overlay_chat.m_FullScreenMode)?"visible":"hidden";b.style.display=(!lz_overlay_chat.m_FullScreenMode)?"block":"none";OverlayChatWidgetV2.UpdateWMIcon(b)}lz_add_class(b,"lz_overlay_wm_button");if(typeof lz_ovlel[c].href!="undefined"){if(typeof lz_ovlel[c].type!="undefined"&&lz_ovlel[c].open=="internal"){b.onclick=function(){OverlayChatWidgetV2.SetMode(this.getAttribute("data-tid"),true)}}else{b.onclick=function(i){return function(){OverlayChatWidgetV2.OpenWindow(i,true)}}(lz_global_base64_url_decode(lz_ovlel[c].href))}}else{if(lz_ovlel[c].type=="knowledgebase"&&lz_kb_external){b.onclick=function(){OverlayChatWidgetV2.Pop("knowledgebase")}}else{if(lz_ovlel[c].type=="knowledgebase"&&lz_kb_embed){b.onclick=function(){OverlayChatWidgetV2.OpenWindow(lz_kb_embed_url,true)}}else{if(lz_ovlel[c].type=="wm"&&lz_chats_external){b.onclick=function(){OverlayChatWidgetV2.Pop("chat")}}else{b.onclick=function(){OverlayChatWidgetV2.SetMode(this.getAttribute("data-tid"),true)}}}}}if(lz_ovlel[c].type=="chat"){var f=b.getElementsByTagName("svg")[0];if(!OverlayChatWidgetV2.IsChatAvailable()){lz_add_class(f,"lz_chat_unavailable")}else{lz_remove_class(f,"lz_chat_unavailable")}if(OverlayChatWidgetV2.__ModeTextInline){var d=b.getElementsByTagName("div")[0];if(!OverlayChatWidgetV2.IsChatAvailable()){lz_add_class(d,"lz_chat_unavailable")}else{lz_remove_class(d,"lz_chat_unavailable")}}}if(lz_ovlel[c].type=="ticket"){if(!lz_ticket_when_online&&OverlayChatWidgetV2.IsChatAvailable()&&lz_chat_human_available){lz_add_class(b,"lz_chat_disabled")}else{lz_remove_class(b,"lz_chat_disabled")}}lz_add_class(b,"lz_overlay_wm_sh_act");lz_add_class(b,"lz_anim_slide_in")}if(OverlayChatWidgetV2.__ModeSingle){lz_chat_overlay_pointer.style.bottom=(parseInt(lz_overlay_chat.m_FrameElement.style.marginBottom.replace("px",""))-13)+"px"}if(lz_chat_get_wm_element("chat")!=null){if(OverlayChatWidgetV2.__ModeSingle||lz_session.OVLWMState=="0"){lz_overlay_wm.m_FrameElement.appendChild(document.getElementById("livezilla_wm_c_chat"))}else{document.getElementById("livezilla_wm_chat").appendChild(document.getElementById("livezilla_wm_c_chat"))}}lz_chat_overlay_pointer.style.display=OverlayChatWidgetV2.__ModeAPI||lz_session.OVLWMSElem==""||lz_session.OVLWMState=="0"||lz_is_mobile||lz_overlay_chat.m_FullScreenMode?"none":"block";if(OverlayChatWidgetV2.__ModeTextInline){var g=lz_session.OVLWMState=="1"&&!OverlayChatWidgetV2.__ModeSingle?"":(lz_d(OverlayChatWidgetV2.ButtonTexts[lz_session.OVLWMSElem])?lz_session.OVLWMSElem:OverlayChatWidgetV2.GetAutoMode());if(g=="phone"){g=!lz_ovlel[1].outbound?"phone_in":"phone_out"}document.getElementById("livezilla_wm_d").innerHTML=g!=""?OverlayChatWidgetV2.ButtonTexts[OverlayChatWidgetV2.GetAutoMode()]:"";if(g!=""&&typeof lz_ovlel_rt_onl!="undefined"){document.getElementById("livezilla_wm_d").innerHTML=lz_global_base64_decode(OverlayChatWidgetV2.IsChatAvailable()?lz_ovlel_rt_onl:lz_ovlel_rt_ofl)}}if(OverlayChatWidgetV2.__Connecting){if(OverlayChatWidgetV2.ChatLoadingElement==null){OverlayChatWidgetV2.ChatLoadingElement=document.createElement("div");OverlayChatWidgetV2.ChatLoadingElement.className="lz_chat_loading";OverlayChatWidgetV2.ChatLoadingElement.innerHTML='<div class="lz_chat_loading_inner"></div>';OverlayChatWidgetV2.ChatLoadingElement.style.maxWidth=document.getElementsByClassName("lz_overlay_wm_icon")[0].style.width;OverlayChatWidgetV2.ChatLoadingElement.style.zIndex=lz_overlay_zindex+100;if(!OverlayChatWidgetV2.__ModeTextInline||lz_overlay_chat.m_FullScreenMode){OverlayChatWidgetV2.ChatLoadingElement.style.margin="0 auto"}}var e;if(lz_session.OVLWMState=="0"||OverlayChatWidgetV2.__ModeSingle){e=document.getElementById("livezilla_wm")}else{if(OverlayChatWidgetV2.IsChatAvailable()){e=document.getElementById("livezilla_wm_chat")}}if(e&&OverlayChatWidgetV2.ChatLoadingElement.parentNode!=e){e.appendChild(OverlayChatWidgetV2.ChatLoadingElement)}}else{if(OverlayChatWidgetV2.ChatLoadingElement!=null){OverlayChatWidgetV2.ChatLoadingElement.parentNode.removeChild(OverlayChatWidgetV2.ChatLoadingElement);OverlayChatWidgetV2.ChatLoadingElement=null}}};OverlayChatWidgetV2.SetGroupInfo=function(){var a=lz_chat_get_wm_element("chat");if(a!=null){document.getElementById("lz_chat_operator_groupname").innerHTML=OverlayChatWidgetV2.ButtonTexts[a.type]}};OverlayChatWidgetV2.SetUIGroup=function(b,a){if(LiveZillaData.Groups!=null){if(LiveZillaData.ForceGroupSelect&&!LiveZillaData.ForceSelectMade){return}if(OverlayChatWidgetV2.__CurrentGroup!=null&&OverlayChatWidgetV2.__FormVisible&&!lz_d(a)){OverlayChatWidgetV2.SetGroupInfo();return}var c=LiveZillaData.Groups.GetGroupById(lz_global_base64_url_decode(b));if(c==null){c=LiveZillaData.Groups.GetGroupById(b)}if(c!=null){OverlayChatWidgetV2.__CurrentGroup=c;LiveZillaData.Groups.SelectGroupById(OverlayChatWidgetV2.__CurrentGroup.Id,document.getElementById("lz_form_groups"));OverlayChatWidgetV2.SetGroupInfo()}OverlayChatWidgetV2.UpdateChatFunctions()}};OverlayChatWidgetV2.UpdateChatFunctions=function(){if(OverlayChatWidgetV2.__CurrentGroup==null){return}var e=OverlayChatWidgetV2.__CurrentGroup.ChatFunctions;if(e!=null){var c=OverlayChatWidgetV2.__CurrentChatId!=0&&(lz_chat_status==2||(lz_chat_status==1&&OverlayChatWidgetV2.__ModeBot&&OverlayChatWidgetV2.BotFeedback))&&!(OverlayChatWidgetV2.__PublicGroupChat!=null&&OverlayChatWidgetV2.__PublicGroupChat.length);document.getElementById("lz_cf_so").style.display=(e!=null&&e[1]=="0")?"none":"block";document.getElementById("lz_cf_pr").style.display=!(e!=null&&e[2]=="0")&&c?"block":"none";if(document.getElementById("lz_chat_feedback_init").style.display!="block"){document.getElementById("lz_chat_feedback_init").style.display=!(e!=null&&e[3]=="0")&&c?"block":"none"}}var a=["lz_cf_tr","lz_cf_so","lz_cf_et","lz_cf_ed","lz_cf_pr","lz_cf_ec","lz_cf_ss"];var d=false;for(var b=0;b<a.length;b++){if(document.getElementById(a[b])!=null&&document.getElementById(a[b]).style.display!="none"){d=true}}document.getElementById("lz_chat_options_button").style.display=d?"block":"none";OverlayChatWidgetV2.UpdateChatInputUI()};OverlayChatWidgetV2.IsFunction=function(c){if(OverlayChatWidgetV2.__CurrentGroup==null){return false}if(c=="ss"&&lz_overlay_chat.m_FullScreenMode){return false}var d=OverlayChatWidgetV2.__CurrentGroup.ChatFunctions;if(d!=null){var a=["sm","so","pr","ra","fv","fu","ss"];for(var b=0;b<a.length;b++){if(a[b]==c){return d[b]=="1"}}}return false};OverlayChatWidgetV2.InitFileUpload=function(){if(lz_session.OVLWMSElem=="chat"&&lz_session.OVLWMState=="0"&&!lz_check_missing_inputs(true)&&!OverlayChatWidgetV2.IsChatActive()){OverlayChatWidgetV2.Show(false);return}document.getElementById("lz_overlay_file_upload").addEventListener("change",OverlayChatWidgetV2.UploadFile,false);setTimeout(function(){document.getElementById("lz_overlay_file_upload").click()},400)};OverlayChatWidgetV2.UploadFile=function(b){if(lz_session.OVLWMSElem=="chat"&&lz_chat_status==0){OverlayChatWidgetV2.FileUploadToStartChat=b;OverlayChatWidgetV2.StartChat();return}else{OverlayChatWidgetV2.FileUploadToStartChat=false}var g,c,e=b.target.files;for(var d=0;g=e[d];d++){var a=new FileReader();a.onload=(function(f){c=g;return function(){var h="form_userfile="+lz_global_base64_encode(f.result);h+="&p_request=extern";h+="&p_action=file_upload";h+="&elem="+lz_session.OVLWMSElem;h+="&bid="+lz_global_base64_url_encode(lz_session.BrowserId);h+="&gid="+lz_global_base64_url_encode(OverlayChatWidgetV2.__CurrentGroup.Id);h+="&uid="+lz_global_base64_url_encode(lz_session.UserId);h+="&find=MQ__&type=file&fname="+lz_global_base64_encode(c.name);if(lz_session.OVLWMSElem=="chat"){h+="&cid="+lz_global_base64_url_encode(OverlayChatWidgetV2.__CurrentChatId)}else{lz_load_inputs=true}lz_post(lz_poll_server+"upload.php?f=MQ__&ptl="+LiveZillaData.Language,h,function(i){document.getElementById("lz_overlay_file_upload").value="";LiveZilla.Engine.Poll(1021)})}})(a);a.readAsDataURL(g)}};OverlayChatWidgetV2.ForwardTicket=function(b,a){function f(g){if(LiveZillaData.Language.length){if(g.indexOf("?")==-1){g+="?language="+LiveZillaData.Language}else{g+="&language="+LiveZillaData.Language}}return g}var c=!a?OverlayChatWidgetV2.OfflineMessageMode:OverlayChatWidgetV2.CallbackMode;var e=!a?OverlayChatWidgetV2.OfflineMessageNewWindow:OverlayChatWidgetV2.CallbackNewWindow;var d=!a?OverlayChatWidgetV2.OfflineMessageHTTP:OverlayChatWidgetV2.CallbackHTTP;if(c==1){if(lz_overlay_chat.m_FullScreenMode||b){if(e){window.location.href=f(d)}else{OverlayChatWidgetV2.OpenWindow(f(d),true)}}return true}return false};OverlayChatWidgetV2.GetAutoMode=function(){var a="NA";if(!lz_hide_widget_by_conf){if(lz_chat_get_wm_element("custom1")!=null&&typeof lz_chat_get_wm_element("custom1").open!="undefined"&&lz_chat_get_wm_element("custom1").open=="internal"){a="custom1"}if(lz_chat_get_wm_element("custom2")!=null&&typeof lz_chat_get_wm_element("custom2").open!="undefined"&&lz_chat_get_wm_element("custom2").open=="internal"){a="custom2"}if(lz_chat_get_wm_element("custom3")!=null&&typeof lz_chat_get_wm_element("custom3").open!="undefined"&&lz_chat_get_wm_element("custom3").open=="internal"){a="custom3"}if(lz_chat_get_wm_element("phone")!=null){a="phone"}if(lz_chat_get_wm_element("knowledgebase")!=null){a="knowledgebase"}if(OverlayChatWidgetV2.OfflineMessageMode!=1||OverlayChatWidgetV2.__ModeClassic||OverlayChatWidgetV2.__ModeSingle){if(lz_chat_get_wm_element("ticket")!=null){a="ticket"}}if(lz_chat_get_wm_element("chat")!=null&&(OverlayChatWidgetV2.IsChatAvailable()||OverlayChatWidgetV2.__ModeBot||a=="NA")&&!lz_chat_declined&&!OverlayChatWidgetV2.__TicketRequired){a="chat"}}return a};OverlayChatWidgetV2.IsChatAvailable=function(){return lz_chat_get_wm_element("chat")!=null&&((OverlayChatWidgetV2.__CurrentGroup!=null&&OverlayChatWidgetV2.__CurrentGroup.Amount>0)||lz_chat_status>0)&&!lz_chat_declined};OverlayChatWidgetV2.ValidateMode=function(){if(OverlayChatWidgetV2.Screenshot!=null){return}var a=OverlayChatWidgetV2.GetAutoMode();if(lz_overlay_wm!=null&&!OverlayChatWidgetV2.__ModeAPI){var b=(a!="NA"||lz_chat_get_wm_element("ticket")!=null)&&!lz_hide_widget_by_conf&&!lz_overlay_chat.m_FixedMode&&!(lz_overlay_chat.m_FullScreenMode&&OverlayChatWidgetV2.__ModeSingle);lz_overlay_wm.SetVisible(b)}if(a=="NA"){lz_overlay_chat.SetVisible(false);if(lz_overlay_chat.m_FullScreenMode){OverlayChatWidgetV2.ForwardTicket(true,false)}}if(lz_session.OVLWMSElem==""||OverlayChatWidgetV2.__ModeSingle||OverlayChatWidgetV2.__ModeClassic||lz_session.OVLWMState=="0"){if(lz_session.OVLWMSElem!=a){if(lz_session.OVLWMSElem=="phone"){return}if(lz_session.OVLWMSElem=="knowledgebase"){return}if(lz_session.OVLWMSElem.indexOf("custom")===0){return}if(lz_session.OVLWMSElem=="feedback"){return}if(!lz_is_mobile||lz_overlay_chat.m_FixedMode||lz_overlay_chat.m_FullScreenMode){OverlayChatWidgetV2.SetMode(a,false)}}}};OverlayChatWidgetV2.SetMode=function(c,b,a){var d;a=(lz_d(a))?a:null;if(a!=null){OverlayChatWidgetV2.TargetGroupId=a}if(b&&c=="wm"){lz_session.OVLWMSElem=OverlayChatWidgetV2.GetAutoMode();OverlayChatWidgetV2.FlipWM()}if(b&&OverlayChatWidgetV2.__ModeTicketReceived){lz_chat_data_form_result()}if(b&&OverlayChatWidgetV2.__ModeTOS){OverlayChatWidgetV2.ToggleTOS(false);return}if(b&&OverlayChatWidgetV2.__ModeFeedback){OverlayChatWidgetV2.ToggleFeedback(false,false);return}if(OverlayChatWidgetV2.__ModeChangeDetails&&b&&c!="chat"){OverlayChatWidgetV2.__ModeChangeDetails=false}if(c=="chat"&&OverlayChatWidgetV2.__TicketRequired&&b){OverlayChatWidgetV2.__TicketRequired=false}if(c=="ticket"&&OverlayChatWidgetV2.ForwardTicket(b,false)){lz_session.OVLWMSElem=OverlayChatWidgetV2.GetAutoMode();if(!lz_overlay_chat.m_FullScreenMode){lz_session.OVLWMState="0"}}else{if(c=="phone"&&OverlayChatWidgetV2.ForwardTicket(b,true)){lz_session.OVLWMSElem=OverlayChatWidgetV2.GetAutoMode();if(!lz_overlay_chat.m_FullScreenMode){lz_session.OVLWMState="0"}}else{if(c=="wm"&&OverlayChatWidgetV2.__ModeSingle&&!OverlayChatWidgetV2.IsChatAvailable()&&OverlayChatWidgetV2.ForwardTicket(b,false)){lz_session.OVLWMSElem="ticket";if(!lz_overlay_chat.m_FullScreenMode){lz_session.OVLWMState="0"}}else{lz_chat_switch_options_table(true,3);if(OverlayChatWidgetV2.__ModeSingle||OverlayChatWidgetV2.__ModeClassic){if(c!="wm"&&c!=""){lz_session.OVLWMSElem=c}else{if(c=="wm"&&!OverlayChatWidgetV2.IsChatAvailable()&&lz_session.OVLWMSElem=="NA"){OverlayChatWidgetV2.ForwardTicket(b,false)}else{if(c=="wm"&&OverlayChatWidgetV2.__ModeSingle&&lz_session.OVLWMSElem==""){lz_session.OVLWMSElem=(OverlayChatWidgetV2.IsChatAvailable())?"chat":"ticket"}}}if(b){lz_session.OVLWMState=(lz_session.OVLWMState=="0")?"1":"0"}d=(lz_session.OVLWMState=="1"&&lz_session.OVLWMSElem!=""&&lz_session.OVLWMSElem!="NA")}else{if(c==""){lz_session.OVLWMState="0"}else{if(c=="wm"){lz_session.OVLWMState=(lz_session.OVLWMState=="0")?"1":"0"}}if(c!="wm"){lz_session.OVLWMSElem=c}if(lz_overlay_chat.m_FullScreenMode){lz_session.OVLWMState="1"}if(lz_is_mobile){d=(lz_session.OVLWMState=="1"&&lz_session.OVLWMSElem!=""&&lz_session.OVLWMSElem!="NA"&&c!="wm")}else{d=(lz_session.OVLWMState=="1"&&lz_session.OVLWMSElem!=""&&lz_session.OVLWMSElem!="NA")}}if(b&&!OverlayChatWidgetV2.__ModeSingle){if(c==lz_session.OVLWMSElem&&!lz_overlay_chat.m_FullScreenMode){if(lz_chat_overlay_pointer!=null&&lz_session.OVLWMState!="0"){if(!OverlayChatWidgetV2.__ModeTextInline){lz_chat_overlay_pointer.style.visibility="hidden"}}}if(c=="knowledgebase"&&document.getElementById("lz_chat_kb_match_info").style.display!="none"){lz_chat_kb_deactivate(false,false)}}}}}if(b&&lz_session.OVLWMState=="0"){OverlayChatWidgetV2.AnswerChatRequest()}else{if(lz_session.OVLWMState=="1"){OverlayChatWidgetV2.ResetPreviewPosts(true)}}lz_session.Save();OverlayChatWidgetV2.UpdateChatUI(d);OverlayChatWidgetV2.UpdateButtonUI();OverlayChatWidgetV2.UpdateWMUI();OverlayChatWidgetV2.UpdateUI();if(lz_session.OVLWMSElem=="chat"){OverlayChatWidgetV2.ScrollDown(63728)}};OverlayChatWidgetV2.APIButtonClick=function(a){document.getElementById("lz_chat_text").value=lz_global_base64_decode(a);OverlayChatWidgetV2.SendMessage(null,null)};OverlayChatWidgetV2.FlipWM=function(){document.getElementById("livezilla_wm").style.transform="rotateX(180deg)";lz_add_class(document.getElementById("livezilla_wm"),"lz_anim_flip");setTimeout(function(){document.getElementById("livezilla_wm").style.transform="";lz_remove_class(document.getElementById("livezilla_wm"),"lz_anim_flip")},500)};OverlayChatWidgetV2.UpdateChatUI=function(a){if(lz_overlay_chat.m_FullScreenMode||(a&&!lz_overlay_chat.IsVisible())){if(OverlayChatWidgetV2.__ModeClassic){OverlayChatWidgetV2.Maximize()}lz_overlay_chat.SetVisible(true);if(lz_is_mobile&&!lz_overlay_chat.m_FullScreenMode){lz_chat_set_zoom(true,true);OverlayChatWidgetV2.ValidateMode();lz_overlay_wm.SetVisible(false)}}if(!lz_overlay_chat.m_FullScreenMode&&(!a&&lz_overlay_chat.IsVisible())){if(lz_is_mobile&&!lz_overlay_chat.m_FullScreenMode){lz_chat_set_zoom(true,false);lz_overlay_wm.SetVisible(true)}if(!lz_is_mobile&&OverlayChatWidgetV2.__ModeClassic){OverlayChatWidgetV2.Minimize()}else{lz_overlay_chat.SetVisible(false)}}};OverlayChatWidgetV2.UpdateUI=function(){OverlayChatWidgetV2.UpdateFormUI();if(OverlayChatWidgetV2.__ModeTicketReceived&&OverlayChatWidgetV2.__ModeSingle&&OverlayChatWidgetV2.IsChatAvailable()){OverlayChatWidgetV2.__ModeTicketReceived=false}if(OverlayChatWidgetV2.__CurrentGroup==null){return}if(typeof lz_ovlel_rt_ofl!="undefined"){lz_header_off=lz_ovlel_rt_ofl}if(typeof lz_ovlel_rt_onl!="undefined"){lz_header_on=lz_ovlel_rt_onl}document.getElementById("lz_chat_data_header").innerHTML="<h2>"+((lz_session.OVLWMSElem=="chat")?((!OverlayChatWidgetV2.__ModeChangeDetails)?lz_text_start_chat:lz_text_change_details):(lz_session.OVLWMSElem=="phone")?lz_req_callback:lz_text_leave_message)+"</h2>";document.getElementById("lz_chat_overlay_text").innerHTML=lz_global_base64_decode(lz_header_off);if(lz_session.OVLWMSElem=="chat"){if(OverlayChatWidgetV2.__ModeChangeDetails){document.getElementById("lz_chat_data_header_text").innerHTML=""}else{if(OverlayChatWidgetV2.IsChatAvailable()&&OverlayChatWidgetV2.__CurrentGroup.ChatInformation.length){document.getElementById("lz_chat_data_header_text").innerHTML=OverlayChatWidgetV2.__CurrentGroup.ChatInformation}else{if(OverlayChatWidgetV2.IsChatAvailable()){document.getElementById("lz_chat_data_header_text").innerHTML=lz_text_chat_information}else{if(OverlayChatWidgetV2.__CurrentGroup.ChatInformationOffline.length){document.getElementById("lz_chat_data_header_text").innerHTML=OverlayChatWidgetV2.__CurrentGroup.ChatInformationOffline}else{document.getElementById("lz_chat_data_header_text").innerHTML=lz_text_chat_information_offline}}}}document.getElementById("lz_chat_overlay_text").innerHTML=lz_global_base64_decode(lz_header_on)}else{if(lz_session.OVLWMSElem=="phone"){if(OverlayChatWidgetV2.__CurrentGroup.CallMeBackInformation.length){document.getElementById("lz_chat_data_header_text").innerHTML=OverlayChatWidgetV2.__CurrentGroup.CallMeBackInformation}else{document.getElementById("lz_chat_data_header_text").innerHTML=lz_text_callback_information}}else{if(lz_session.OVLWMSElem=="ticket"){if(OverlayChatWidgetV2.__CurrentGroup.TicketInformation.length){document.getElementById("lz_chat_data_header_text").innerHTML=OverlayChatWidgetV2.__CurrentGroup.TicketInformation}else{document.getElementById("lz_chat_data_header_text").innerHTML=lz_text_ticket_information}}}}document.getElementById("lz_chat_overlay_ticket").style.display=(OverlayChatWidgetV2.__ModeTicketReceived)?"block":"none";document.getElementById("lz_overlay_module_knowledgebase").style.visibility=(lz_session.OVLWMSElem=="knowledgebase")?"visible":"hidden";document.getElementById("lz_overlay_module_custom").style.visibility=(lz_session.OVLWMSElem!=null&&lz_session.OVLWMSElem.indexOf("custom")===0)?"visible":"hidden";document.getElementById("lz_overlay_module_feedback").style.visibility=(OverlayChatWidgetV2.__ModeFeedback)?"visible":"hidden";document.getElementById("lz_overlay_module_feedback").style.display=(OverlayChatWidgetV2.__ModeFeedback)?"block":"none";document.getElementById("lz_overlay_module_tos").style.display=(OverlayChatWidgetV2.__ModeTOS)?"block":"none";document.getElementById("lz_chat_content_box").style.display=(lz_session.OVLWMSElem=="chat")?"block":"none";document.getElementById("lz_overlay_phone_inbound").style.display=(lz_mode_phone_inbound&&lz_session.OVLWMSElem=="phone"&&!OverlayChatWidgetV2.__ModeTOS&&!OverlayChatWidgetV2.__ModeTicketReceived)?"block":"none";if(lz_session.OVLWMSElem=="phone"&&lz_mode_phone_inbound){document.getElementById("lz_chat_data_form").style.top="180px";lz_add_class(document.getElementById("lz_chat_data_header"),"lz_chat_sub_header")}else{document.getElementById("lz_chat_data_form").style.top="0";lz_remove_class(document.getElementById("lz_chat_data_header"),"lz_chat_sub_header")}if(lz_session.OVLWMSElem=="knowledgebase"){if(document.getElementById("lz_overlay_module_knowledgebase").getElementsByTagName("iframe")[0].src==""){lz_kb_set_url("")}}if(lz_session.OVLWMSElem!=null&&lz_session.OVLWMSElem.indexOf("custom")===0){OverlayChatWidgetV2.SetCustomURL()}OverlayChatWidgetV2.__FormVisible=true;var a=OverlayChatWidgetV2.IsChatActive();if(a){OverlayChatWidgetV2.__FormConfirmRequired=false}if(!OverlayChatWidgetV2.__ModeChangeDetails){if(lz_session.OVLWMSElem=="chat"&&(OverlayChatWidgetV2.ChatStarted||OverlayChatWidgetV2.ChatEnded||OverlayChatWidgetV2.ChatInitiated||OverlayChatWidgetV2.__Connecting)){OverlayChatWidgetV2.__FormVisible=false}else{if(lz_session.OVLWMSElem=="chat"&&OverlayChatWidgetV2.__ModeBot&&!OverlayChatWidgetV2.BotForm){OverlayChatWidgetV2.__FormVisible=false}else{if(OverlayChatWidgetV2.__ModeTicketReceived||OverlayChatWidgetV2.__ModeFeedback||OverlayChatWidgetV2.__ModeTOS){OverlayChatWidgetV2.__FormVisible=false}else{if(lz_session.OVLWMSElem=="phone"&&!lz_mode_phone_outbound){OverlayChatWidgetV2.__FormVisible=false}else{if(lz_session.OVLWMSElem=="knowledgebase"){OverlayChatWidgetV2.__FormVisible=false}else{if(lz_session.OVLWMSElem.indexOf("custom")===0){OverlayChatWidgetV2.__FormVisible=false}else{if(lz_session.OVLWMSElem=="chat"&&!OverlayChatWidgetV2.__FormConfirmRequired){if(lz_chat_status>0||a){OverlayChatWidgetV2.__FormVisible=false}else{if(lz_check_missing_inputs(false,null)&&!OverlayChatWidgetV2.__PublicGroupChat.length){if(OverlayChatWidgetV2.IsChatAvailable()){if(!(LiveZillaData.ForceGroupSelect&&!LiveZillaData.ForceSelectMade)){OverlayChatWidgetV2.__FormVisible=false}}}}}}}}}}}}document.getElementById("lz_overlay_module_chat").style.display=(!OverlayChatWidgetV2.__FormVisible&&lz_session.OVLWMSElem=="chat"&&!OverlayChatWidgetV2.__ModeFeedback&&!OverlayChatWidgetV2.__ModeTOS&&!OverlayChatWidgetV2.__ModeChangeDetails)?"block":"none";if(OverlayChatWidgetV2.__FormVisible&&!a&&lz_session.OVLWMSElem=="chat"&&OverlayChatWidgetV2.IsChatAvailable()&&LiveZillaData.InputFieldIndices!=null&&lz_session.OVLWMState=="1"){OverlayChatWidgetV2.__FormConfirmRequired=true}OverlayChatWidgetV2.UpdateMessageInput();document.getElementById("lz_chat_data_form").style.display=OverlayChatWidgetV2.__FormVisible?"block":"none";document.getElementById("lz_chat_ticket_received").style.display=(OverlayChatWidgetV2.__ModeTicketReceived&&!lz_flood&&!(OverlayChatWidgetV2.__ModeSingle&&OverlayChatWidgetV2.IsChatAvailable()))?"":"none"};OverlayChatWidgetV2.UpdateMessageInput=function(){try{if(lz_session.OVLWMState=="1"){if(OverlayChatWidgetV2.__FormVisible&&document.getElementById("lz_chat_text").value.length&&!document.getElementsByName("form_114")[0].value.length){document.getElementsByName("form_114")[0].value=document.getElementById("lz_chat_text").value;document.getElementById("lz_chat_text").value="";lz_chat_save_input_value("114",document.getElementsByName("form_114")[0].value);lz_check_missing_inputs(true)}else{if(lz_chat_status==0&&!OverlayChatWidgetV2.__Connecting&&!OverlayChatWidgetV2.ChatStarted&&!OverlayChatWidgetV2.ChatInitiated&&!OverlayChatWidgetV2.__FormVisible&&!document.getElementById("lz_chat_text").value.length&&document.getElementsByName("form_114")[0].value.length){document.getElementById("lz_chat_text").value=document.getElementsByName("form_114")[0].value;document.getElementsByName("form_114")[0].value=""}}}}catch(a){console.log(a)}};OverlayChatWidgetV2.IsChatActive=function(){return(OverlayChatWidgetV2.ChatStarted||OverlayChatWidgetV2.ChatInitiated||lz_chat_status>0)};OverlayChatWidgetV2.UpdateButtonUI=function(){lz_remove_class(document.getElementById("lz_chat_overlay_data_form_ok_button"),"lz_chat_disabled");document.getElementById("lz_chat_overlay_data_form_ok_button").innerHTML=(lz_session.OVLWMSElem=="chat")?((OverlayChatWidgetV2.__ModeChangeDetails)?lz_text_save:(!OverlayChatWidgetV2.IsChatAvailable())?lz_text_not_available:lz_text_start_chat):(lz_session.OVLWMSElem=="phone")?lz_call_me:lz_text_leave_message;if(lz_session.OVLWMSElem=="chat"&&!OverlayChatWidgetV2.IsChatAvailable()){if(lz_chat_get_wm_element("ticket")!=null){document.getElementById("lz_chat_overlay_data_form_ok_button").innerHTML=lz_text_leave_message}else{lz_add_class(document.getElementById("lz_chat_overlay_data_form_ok_button"),"lz_chat_disabled")}}};OverlayChatWidgetV2.UpdateWMIcon=function(a){if(lz_session.OVLWMState=="1"){OverlayChatWidgetV2.ApplyIconToElement(a,"close")}else{if(typeof lz_ovlel_ri!="undefined"){OverlayChatWidgetV2.ApplyIconToElement(a,lz_ovlel_ri)}else{OverlayChatWidgetV2.ApplyIconToElement(a,"comments");if(OverlayChatWidgetV2.__ModeSingle){if(lz_session.OVLWMSElem=="chat"&&lz_chat_get_wm_element("chat")!=null){OverlayChatWidgetV2.ApplyIconToElement(a,lz_chat_get_wm_element("chat").icon)}else{if(lz_session.OVLWMSElem=="ticket"&&lz_chat_get_wm_element("ticket")!=null){OverlayChatWidgetV2.ApplyIconToElement(a,lz_chat_get_wm_element("ticket").icon)}else{if(lz_session.OVLWMSElem==""&&!OverlayChatWidgetV2.IsChatAvailable()&&lz_chat_get_wm_element("ticket")!=null){OverlayChatWidgetV2.ApplyIconToElement(a,lz_chat_get_wm_element("ticket").icon)}else{if(lz_ovlel.length>1){OverlayChatWidgetV2.ApplyIconToElement(a,lz_ovlel[1].icon)}else{if(lz_ovlel.length==1){OverlayChatWidgetV2.ApplyIconToElement(a,lz_ovlel[0].icon)}}}}}}else{if(lz_chat_get_wm_element("chat")==null||!OverlayChatWidgetV2.IsChatAvailable()){if(lz_chat_get_wm_element("ticket")!=null){OverlayChatWidgetV2.ApplyIconToElement(a,"envelope")}else{OverlayChatWidgetV2.ApplyIconToElement(a,"question")}}}}}};OverlayChatWidgetV2.ApplyIconToElement=function(b,a){var h=-12*OverlayChatWidgetV2.__Ratio;var g=-11*OverlayChatWidgetV2.__Ratio;var c=OverlayChatWidgetV2.__SizeHeight;var f=14;var d=lz_get_icon_data(a);b.getElementsByTagName("path")[0].setAttribute("d",d.path);if(lz_d(d.vx)){h=d.vx*OverlayChatWidgetV2.__Ratio}if(lz_d(d.vy)){g=d.vy*OverlayChatWidgetV2.__Ratio}b.getElementsByTagName("svg")[0].setAttribute("viewBox",h+" "+g+" "+c+" "+c);if(lz_d(d.t)){f=d.t}var e="scale(.0"+Math.floor(f*OverlayChatWidgetV2.__Ratio).toString()+")";b.getElementsByTagName("path")[0].setAttribute("transform",e);b.getElementsByTagName("path")[0].style.transform=e};OverlayChatWidgetV2.Minimize=function(){lz_session.OVLWMState="0";lz_session.Save();document.getElementById("lz_chat_content").style.display="none";document.getElementById("lz_chat_overlay_text").style.display="block";document.getElementById("lz_chat_overlay_main").style.boxShadow="none";OverlayChatWidgetV2.SetSize(260,40)};OverlayChatWidgetV2.Maximize=function(){if(!lz_chats_external){if(OverlayChatWidgetV2.__ModeClassic&&!OverlayChatWidgetV2.IsChatAvailable()&&OverlayChatWidgetV2.ForwardTicket(true,false)){OverlayChatWidgetV2.Minimize();return}lz_session.OVLWMState="1";lz_session.Save();document.getElementById("lz_chat_content").style.display="block";document.getElementById("lz_chat_overlay_text").style.display="none";document.getElementById("lz_chat_overlay_main").style.boxShadow="0 0 10px #888";OverlayChatWidgetV2.SetSize(lz_overlay_chat_width,lz_overlay_chat_height);OverlayChatWidgetV2.UpdateUI();OverlayChatWidgetV2.UpdateWaitingPosts(0);OverlayChatWidgetV2.UpdateChatHistoryUI();OverlayChatWidgetV2.ScrollDown(77297);OverlayChatWidgetV2.ResetPreviewPosts()}else{OverlayChatWidgetV2.Open(false)}};OverlayChatWidgetV2.SetSize=function(a,b){lz_overlay_chat.m_FrameElement.style.width=a+"px";lz_overlay_chat.m_FrameElement.style.height=b+"px";if(OverlayChatWidgetV2.PostPreview!=null){OverlayChatWidgetV2.PostPreview.m_FrameElement.style.width=(lz_overlay_wm==null?260:(lz_overlay_chat_width*0.7))+"px"}};OverlayChatWidgetV2.Open=function(a){if(lz_chats_external){OverlayChatWidgetV2.Pop("chat")}else{if(OverlayChatWidgetV2.__ModeClassic){lz_overlay_chat.SetVisible(true);OverlayChatWidgetV2.Maximize()}else{if(lz_chat_get_wm_element("chat")!=null){lz_session.OVLWMState="1";OverlayChatWidgetV2.SetMode(OverlayChatWidgetV2.GetAutoMode(),false)}else{OverlayChatWidgetV2.SetMode(OverlayChatWidgetV2.GetAutoMode(),true)}}}if(a){OverlayChatWidgetV2.PlaySound(OverlayChatWidgetV2.NotificationSound)}};OverlayChatWidgetV2.ExitBotChat=function(b,c,d,a){a=lz_d(a)?a:false;if(OverlayChatWidgetV2.__ModeBot){OverlayChatWidgetV2.__ModeBot=false;OverlayChatWidgetV2.__NoBotChat=b;if(c&&b){OverlayChatWidgetV2.ExitChat()}}if(a){if(document.getElementById("BotWelcomeMessage")!=null){document.getElementById("BotWelcomeMessage").parentElement.removeChild(document.getElementById("BotWelcomeMessage"))}}};OverlayChatWidgetV2.ExitChat=function(a){a=lz_d(a)?a:true;OverlayChatWidgetV2.ChatInitiated=false;OverlayChatWidgetV2.ChatStarted=false;if(a){lz_leave_chat=true;LiveZilla.Engine.Poll(1120)}else{OverlayChatWidgetV2.ChatEnded=true}};OverlayChatWidgetV2.InitChat=function(b,a){OverlayChatWidgetV2.ChatInitiated=true;OverlayChatWidgetV2.ChatStarted=true;OverlayChatWidgetV2.ChatEnded=false;if(lz_d(b)&&b!=null){OverlayChatWidgetV2.TargetOperatorId=b}else{OverlayChatWidgetV2.TargetOperatorId=null}if(lz_d(a)&&a!=null){OverlayChatWidgetV2.TargetGroupId=a;OverlayChatWidgetV2.SetUIGroup(a)}LiveZilla.Engine.Poll(1311,true)};OverlayChatWidgetV2.SetGroups=function(a,b){LiveZillaData.ForceGroupSelect=OverlayChatWidgetV2.ForceGroupSelect;if(LiveZillaData.Groups==null){LiveZillaData.Groups=new lz_group_list(document,document.getElementById("lz_form_groups"))}LiveZillaData.Groups.StatusIcon=false;LiveZillaData.Groups.CreateHeader(lz_text_please_select);LiveZillaData.Groups.Update(a);if(lz_d(b)&&b.length){OverlayChatWidgetV2.SetUIGroup(b,true)}};OverlayChatWidgetV2.ToggleTOS=function(a){OverlayChatWidgetV2.__ModeTOS=a;OverlayChatWidgetV2.UpdateUI();if(lz_overlay_chat.m_FixedMode||lz_overlay_chat.m_FullScreenMode){document.getElementById("lz_chat_overlay_minimize").style.display=(a)?"block":"none"}};OverlayChatWidgetV2.ToggleFeedback=function(c,b){b=(lz_d(b))?b:false;if(b){OverlayChatWidgetV2.FeedbackOnMouseMove=true}else{if(lz_chat_status==1&&!(OverlayChatWidgetV2.BotFeedback&&OverlayChatWidgetV2.__ModeBot)){return}if(c){var a="wt=ovlv2&etc="+lz_global_base64_url_encode(lz_color_primary)+"&ptl="+LiveZillaData.Language;if(OverlayChatWidgetV2.__CurrentChatId!=0){a+="&cid="+lz_global_base64_url_encode(OverlayChatWidgetV2.__CurrentChatId)}else{if(OverlayChatWidgetV2.__LastChatId!=0){a+="&cid="+lz_global_base64_url_encode(OverlayChatWidgetV2.__LastChatId)}}var d=document.getElementById("lz_overlay_module_feedback_content").getElementsByTagName("iframe")[0];if(d.src!=lz_poll_server+"feedback.php?"+a){document.getElementById("lz_overlay_module_feedback").style.display="block";d.src=lz_poll_server+"feedback.php?"+a}}OverlayChatWidgetV2.__ModeFeedback=c;OverlayChatWidgetV2.UpdateUI();if(lz_overlay_chat.m_FullScreenMode){document.getElementById("lz_chat_overlay_minimize").style.display=(c)?"block":"none"}}if(b&&lz_is_mobile){OverlayChatWidgetV2.MouseMove(null)}};OverlayChatWidgetV2.MouseMove=function(a){OverlayChatWidgetV2.__PostsNoticed=true;OverlayChatWidgetV2.MouseMoveEvent=a;if(OverlayChatWidgetV2.FeedbackOnMouseMove){OverlayChatWidgetV2.FeedbackOnMouseMove=false;setTimeout(function(){if(!OverlayChatWidgetV2.__Connecting&&lz_chat_status==0&&!OverlayChatWidgetV2.ChatStarted){OverlayChatWidgetV2.ToggleFeedback(true,false)}},3000)}};OverlayChatWidgetV2.SetStatus=function(g,c,b,e,f,a){if(lz_overlay_chat!=null){var d=(lz_session.OVLWMSElem=="chat");lz_hide_widget_by_conf=g;if(a==0&&lz_chat_status!=a&&lz_chat_status!=-1){OverlayChatWidgetV2.ExitChat(false)}lz_chat_status=a;lz_chat_declined=false;lz_chat_human_available=e;if(OverlayChatWidgetV2.CurrentOperator!=null||OverlayChatWidgetV2.__Connecting){c=true}if(OverlayChatWidgetV2.__ModeChangeDetails&&c!=d){lz_chat_switch_details(true)}if(!c&&document.getElementById("lz_chat_text").value.length>0&&document.getElementsByName("form_114")[0].value.length==0){document.getElementsByName("form_114")[0].value=document.getElementById("lz_chat_text").value}if(!c&&document.getElementById("lz_chat_queued_posts")!=null){document.getElementById("lz_chat_content_box").removeChild(document.getElementById("lz_chat_queued_posts"))}OverlayChatWidgetV2.UpdateChatFunctions();OverlayChatWidgetV2.ValidateMode();OverlayChatWidgetV2.UpdateUI();OverlayChatWidgetV2.UpdateWMUI();OverlayChatWidgetV2.UpdateButtonUI()}};OverlayChatWidgetV2.Pop=function(c,a){c=(typeof c!="undefined")?c:lz_session.OVLWMSElem;var b=lz_poll_server;var d=false;if(c=="knowledgebase"){b+="knowledgebase.php";b+="?etc="+lz_global_base64_url_encode(lz_color_secondary);b+="&linkid="+lz_global_base64_url_encode(lz_code_id);if(LiveZillaData.Language.length){b+="&ptl="+LiveZillaData.Language}b+="&ckf="+lz_kb_root;d=true}else{b+="chat.php?v=2&linkid="+lz_global_base64_url_encode(lz_code_id);if(typeof OverlayChatWidgetV2!="undefined"&&OverlayChatWidgetV2.__PublicGroupChat.length){b+="&pgc="+OverlayChatWidgetV2.__PublicGroupChat}}if(typeof a!="undefined"){b+=a}OverlayChatWidgetV2.OpenWindow(b,d)};OverlayChatWidgetV2.OpenWindow=function(b,a){if(a){window.open(b,"LiveZilla")}else{var c=(typeof OverlayChatWidgetV2!="undefined"&&OverlayChatWidgetV2.__PublicGroupChat.length)?Math.max(lz_window_width,600):lz_window_width;window.open(b,"LiveZilla","width="+c+",height="+lz_window_height+",left=50,top=50,resizable=yes,menubar=no,location=no,status=yes,slidebars=no")}};OverlayChatWidgetV2.Show=function(a){OverlayChatWidgetV2.Open(a)};OverlayChatWidgetV2.Hide=function(){lz_chat_hide()};OverlayChatWidgetV2.InputKeyUp=function(a){if(a!=null&&a.keyCode==13){if(lz_session.OVLWMState=="0"&&!lz_check_missing_inputs(true)&&!OverlayChatWidgetV2.IsChatActive()){OverlayChatWidgetV2.Show(false)}else{if(!a.ctrlKey){if(!OverlayChatWidgetV2.IsChatActive()){OverlayChatWidgetV2.ChatInitiated=true}OverlayChatWidgetV2.SendMessage(null,null)}}}else{lz_chat_switch_extern_typing(true)}OverlayChatWidgetV2.UpdateChatInputUI()};OverlayChatWidgetV2.AddSystemMessage=function(b){var c=document.createElement("div");var a=document.createElement("div");a.className="lz_overlay_chat_status_inner";a.innerHTML=b;c.appendChild(a);document.getElementById("lz_chat_content_inlay").appendChild(c);lz_chat_last_poster="SYS"};OverlayChatWidgetV2.AddParameters=function(){var c="",a;if(OverlayChatWidgetV2.CurrentOperator!=null){c+="&op="+lz_global_base64_url_encode(OverlayChatWidgetV2.CurrentOperator.Id)}if(OverlayChatWidgetV2.MessageSneakPeek&&document.getElementById("lz_chat_text")!=null){c+="&typ="+lz_global_base64_url_encode(lz_global_trim(document.getElementById("lz_chat_text").value))}else{if(lz_external.Typing){c+="&typ=MQ__"}}if(lz_chat_full_load&&!lz_chat_declined){c+="&full=1"}if(lz_leave_chat){c+="&clch=MQ__"}if(lz_chat_init_feedback){lz_chat_init_feedback=false;c+="&ovlif=MQ__"}if(OverlayChatWidgetV2.AcceptCR){OverlayChatWidgetV2.AcceptCR=false;c+="&accreq=MQ__"}else{if(OverlayChatWidgetV2.DeclineCR){OverlayChatWidgetV2.DeclineCR=false;c+="&decreq=MQ__"}}if(lz_chat_kb_search_phrase!=""){c+="&skb="+lz_global_base64_url_encode(lz_chat_kb_search_phrase)}if(lz_chat_status_change){c+="&sc=1"}if(!lz_leave_chat){if(OverlayChatWidgetV2.__NoBotChat){c+="&tth=MQ__"}if(OverlayChatWidgetV2.ChatInitiated){c+="&ic=MQ__"}}if(lz_overlay_chat!=null&&lz_overlay_chat.m_FullScreenMode){c+="&hinv=MQ__"}if(OverlayChatWidgetV2.TargetOperatorId!=null){c+="&operator="+encodeURIComponent(OverlayChatWidgetV2.TargetOperatorId)}if(OverlayChatWidgetV2.TargetGroupId!=null){c+="&eg="+encodeURIComponent(OverlayChatWidgetV2.TargetGroupId)}else{if(OverlayChatWidgetV2.__CurrentGroup!=null){c+="&eg="+encodeURIComponent(OverlayChatWidgetV2.__CurrentGroup.Id)}}if(lz_force_monitoring){c+="&fm=MQ__"}if(OverlayChatWidgetV2.ChatStarted&&lz_chat_status==0){LiveZillaData.WriteToServer=true}if(LiveZillaData.WriteToServer&&LiveZillaData.InputFieldValues!=null){for(a=0;a<LiveZillaData.InputFieldValues.length;a++){if(LiveZillaData.InputFieldValues[a].Type!="File"&&LiveZillaData.InputFieldValues[a].Value!=""){c+="&f"+LiveZillaData.InputFieldValues[a].Index+"="+lz_global_base64_url_encode(LiveZillaData.InputFieldValues[a].Value)}}if(lz_session.OVLWMSElem=="chat"){c+="&tc="+lz_global_base64_url_encode(lz_session.Transcript.toString())}LiveZillaData.WriteToServer=false}if(lz_ticket!=null){c+="&tid="+lz_global_base64_url_encode(lz_ticket);c+="&cmb="+lz_global_base64_url_encode(lz_session.OVLWMSElem=="phone"?"1":"0");lz_ticket=null}lz_chat_status_change=false;if(OverlayChatWidgetV2.__LastPostReceived!=null){c+="&lpr="+lz_global_base64_url_encode(OverlayChatWidgetV2.__LastPostReceived);if(OverlayChatWidgetV2.__IsPostStatusUpdate||(OverlayChatWidgetV2.__IsWaitingForNotice&&OverlayChatWidgetV2.__PostsNoticed)){c+="&lps="+lz_global_base64_url_encode(OverlayChatWidgetV2.__PostsNoticed?"2":"1");OverlayChatWidgetV2.__IsPostStatusUpdate=false;OverlayChatWidgetV2.__IsWaitingForNotice=!OverlayChatWidgetV2.__PostsNoticed}}if(lz_chat_last_message_received!=null){c+="&lmr="+lz_global_base64_url_encode(lz_chat_last_message_received)}if(lz_chat_last_poster!=null){c+="&lp="+lz_global_base64_url_encode(lz_chat_last_poster)}var b=0;for(a=0;a<lz_external.MessagesSent.length;a++){if(!lz_external.MessagesSent[a].Received){c+="&mi"+b.toString()+"="+lz_global_base64_url_encode(lz_external.MessagesSent[a].MessageId)+"&mp"+(b).toString()+"="+lz_global_base64_url_encode(lz_external.MessagesSent[a].MessageText.substr(0,600))+"&mpt"+(b).toString()+"="+lz_global_base64_url_encode(lz_external.MessagesSent[a].MessageTranslationText.substr(0,600))+"&mpti"+(b++).toString()+"="+lz_global_base64_url_encode((lz_session.TransFrom!=null)?lz_session.TransFrom:"")}}if(OverlayChatWidgetV2.__PublicGroupChat.length){c+="&pgc="+OverlayChatWidgetV2.__PublicGroupChat}return c};OverlayChatWidgetV2.CaptureScreen=function(c,e,f){if(lz_session.OVLWMSElem=="chat"&&lz_session.OVLWMState=="0"&&!lz_check_missing_inputs(true)&&!OverlayChatWidgetV2.IsChatActive()){OverlayChatWidgetV2.Show(false);return}if(!f&&lz_session.OVLWMSElem=="chat"&&lz_chat_status==0){OverlayChatWidgetV2.ScreenCaptureToStartChat=true;OverlayChatWidgetV2.StartChat();return}if(!c){setTimeout(function(){OverlayChatWidgetV2.CaptureScreen(true,e,f)},200);return}if(!f){var b=lz_overlay_chat!=null&&lz_overlay_chat.IsVisible();var o=OverlayChatWidgetV2.PostPreview!=null&&OverlayChatWidgetV2.PostPreview.IsVisible();var k=lz_overlay_wm!=null&&lz_overlay_wm.IsVisible();if(b){lz_overlay_chat.SetVisible(false)}if(o){OverlayChatWidgetV2.PostPreview.SetVisible(false)}if(k){lz_overlay_wm.SetVisible(false)}}var l=document.body.cloneNode(true);var g,n,m=[];var j=document.querySelectorAll("input, textarea, select");for(g=0;g<j.length;g++){if(lz_d(j[g].value)&&j[g].value.length){if(lz_d(j[g].id)&&j[g].id.toString().length){m.push({value:j[g].value});m[m.length-1].id=j[g].id}else{if(lz_d(j[g].name)&&j[g].name.toString().length){m.push({value:j[g].value});m[m.length-1].name=j[g].name}}}}var d=["lvztr","lz_r_scr","lz_overlay"];j=l.querySelectorAll("div, script");for(g=0;g<j.length;g++){for(n=0;n<d.length;n++){if(j[g].id.indexOf(d[n])===0){j[g].parentNode.removeChild(j[g])}}}var a=new Blob([l.innerHTML],{type:"text/html"});var h=new FileReader();h.readAsDataURL(a);h.onloadend=function(){OverlayChatWidgetV2.Screenshot=h.result+"|||"+lz_global_base64_encode(window.location.href)+"|||"+lz_global_base64_encode(JSON.stringify(m));OverlayChatWidgetV2.Screenshot+="|||"+lz_global_get_window_width()+"|||"+lz_global_get_window_height();OverlayChatWidgetV2.Screenshot+="|||"+lz_global_get_page_offset_x()+"|||"+lz_global_get_page_offset_y();if(OverlayChatWidgetV2.MouseMoveEvent!=null&&lz_d(OverlayChatWidgetV2.MouseMoveEvent.clientX)){OverlayChatWidgetV2.Screenshot+="|||"+OverlayChatWidgetV2.MouseMoveEvent.clientX+"|||"+OverlayChatWidgetV2.MouseMoveEvent.clientY}var r="form_userfile="+lz_global_base64_encode(OverlayChatWidgetV2.Screenshot);r+="&p_request=extern";r+="&p_action=file_upload";if(f){r+="&elem=chat"}else{r+="&elem="+lz_session.OVLWMSElem}r+="&bid="+lz_global_base64_url_encode(lz_session.BrowserId);r+="&gid="+lz_global_base64_url_encode(OverlayChatWidgetV2.__CurrentGroup.Id);r+="&uid="+lz_global_base64_url_encode(lz_session.UserId);if(!lz_d(e)){e=-1}if(f){r+="&p_stream=1"}r+="&find="+lz_global_base64_url_encode(e)+"&type=screenshot&fname="+lz_global_base64_encode("screenshot.lzsc");if(lz_session.OVLWMSElem=="chat"||f){r+="&cid="+lz_global_base64_url_encode(OverlayChatWidgetV2.__CurrentChatId)}else{if(!f){lz_load_inputs=true}}lz_post(lz_poll_server+"upload.php?f=MQ__&ptl="+LiveZillaData.Language,r,function(s){if(!f){LiveZilla.Engine.Poll(1021)}});if(!f){var i=document.getElementById("lz_chat_flash");i=document.createElement("div");i.id="lz_chat_flash";document.body.appendChild(i);var p=1;var q=setInterval(function(){p-=0.025;i.style.opacity=p;if(p<=0){i.parentNode.removeChild(i);clearInterval(q);if(b){lz_overlay_chat.SetVisible(true)}if(o){OverlayChatWidgetV2.PostPreview.SetVisible(true)}if(k){lz_overlay_wm.SetVisible(true)}OverlayChatWidgetV2.Screenshot=null;OverlayChatWidgetV2.ScrollDown(83754)}},30)}}};OverlayChatWidgetV2.ShowCustomPage=function(a){alert(a)};OverlayChatWidgetV2.SetCustomURL=function(){document.getElementById("lz_overlay_module_custom").style.display="block";var a=lz_global_base64_url_decode(lz_chat_get_wm_element(lz_session.OVLWMSElem).href);var b=document.getElementById("lz_overlay_module_custom").getElementsByTagName("iframe")[0];if(!lz_d(b.dataset.curl)){b.dataset.curl=""}if(b.dataset.curl!=a){b.dataset.curl=a;b.src=a}document.getElementById("lz_overlay_module_custom").getElementsByTagName("h2")[0].innerHTML=lz_global_base64_url_decode(lz_chat_get_wm_element(lz_session.OVLWMSElem).title)};OverlayChatWidgetV2.AnswerChatRequest=function(a,b){a=lz_d(a)?a:false;if(a){OverlayChatWidgetV2.AcceptCR=true}else{OverlayChatWidgetV2.DeclineCR=true}if(b){LiveZilla.Engine.Poll(34912)}};OverlayChatWidgetV2.UpdateChatInputUI=function(){var a=parseInt(document.getElementById("lz_chat_text").style.height.replace("px","")),b=document.getElementById("lz_chat_text");if(isNaN(a)){a=50}if(b.clientHeight<b.scrollHeight){a+=22;b.style.height=a+"px"}else{if(document.getElementById("lz_chat_text").value==""){a=50;b.style.height=a+"px"}}document.getElementById("lz_chat_text_send").style.display=(document.getElementById("lz_chat_text").value.length>0)?"block":"none";document.getElementById("lz_chat_text_file").style.right=OverlayChatWidgetV2.IsFunction("ss")?"40px":"10px";document.getElementById("lz_chat_text_send").style.right=(OverlayChatWidgetV2.IsFunction("ss")&&OverlayChatWidgetV2.IsFunction("fu")?"70px":(OverlayChatWidgetV2.IsFunction("ss")||OverlayChatWidgetV2.IsFunction("fu")?"40px":"10px"));document.getElementById("lz_chat_text_file").style.display=OverlayChatWidgetV2.IsFunction("fu")?"block":"none";document.getElementById("lz_chat_text_sc").style.display=OverlayChatWidgetV2.IsFunction("ss")?"block":"none";document.getElementById("lz_chat_overlay_info").style.bottom=(15+a+"px");document.getElementById("lz_chat_members_box").style.bottom=document.getElementById("lz_chat_content_box").style.bottom=(OverlayChatWidgetV2.__Connecting)?(56+a+"px"):(16+a+"px");document.getElementById("lz_chat_overlay_info").style.display=(OverlayChatWidgetV2.__Connecting)?"block":"none";if(document.getElementById("lz_overlay_preview_tctrl")!=null){document.getElementById("lz_overlay_preview_tctrl").style.height=10+a+"px"}document.getElementById("lz_chat_overlay_bottom").style.height=10+a+"px"};OverlayChatWidgetV2.ScrollDown=function(a){setTimeout(function(){if(document.getElementById("lz_chat_content_box")!=null){document.getElementById("lz_chat_content_box").scrollTop=document.getElementById("lz_chat_content_box").scrollHeight}},100)};OverlayChatWidgetV2.RemoveInvite=function(b){var a=document.getElementById(b);if(a!=null){if(lz_session.OVLWMState=="0"){a.parentNode.parentNode.removeChild(a.parentNode)}else{a.parentNode.removeChild(a)}}};OverlayChatWidgetV2.ShowWaitingMessage=function(a){if(lz_chat_status<2){OverlayChatWidgetV2.AddMessages(lz_global_base64_encode(JSON.stringify([[a,"WAIM"]])),false,null,null,"sys")}};OverlayChatWidgetV2.SetConnectionState=function(c,b,a,d){if(b!=null){lz_external.Id=b}if(c&&LiveZillaData.TimerWaiting==null&&a!=null){LiveZillaData.TimerWaiting=setTimeout(function(){OverlayChatWidgetV2.ShowWaitingMessage(a)},d*1000)}else{if(!c&&LiveZillaData.TimerWaiting!=null){clearTimeout(LiveZillaData.TimerWaiting);LiveZillaData.TimerWaiting=null}}OverlayChatWidgetV2.__Connecting=c;if(c){lz_chat_set_typing(null,false)}OverlayChatWidgetV2.UpdateChatInputUI()}};