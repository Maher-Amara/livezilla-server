function lz_he_setCursor(h){if(document.getElementById("wysiwyg"+h)!=null){var l=document.getElementById("wysiwyg"+h).contentWindow;var e=l.document.body;var j=l.document.getSelection();if(j!=null){try{var a=j.getRangeAt(0);if(e.lastChild&&e.lastChild!=null){var i=e.lastChild.childNodes.length;var k=(e.lastChild.nodeType==3)?e.lastChild.nodeValue.length:(e.lastChild.tagName=="BR")?0:i;try{a.setStart(e.lastChild,k);a.setEnd(e.lastChild,k)}catch(f){}j.removeAllRanges();j.addRange(a)}}catch(f){}}}}function lz_he_getSelectionText(h){if(document.getElementById("wysiwyg"+h)!=null){var j=document.getElementById("wysiwyg"+h).contentWindow;var a=j.document.getSelection();if(a!=null){try{var i=lz_he_getCursorPosition(h);var f=a.getRangeAt(0).startContainer.parentNode.innerHTML;f=f.substr(0,i);return f.replace(/<br>/g," ")}catch(e){}}}return null}function lz_he_replaceSelectionText(l,i,f){if(document.getElementById("wysiwyg"+l)!=null){var j=document.getElementById("wysiwyg"+l).contentWindow;var h=j.document.getSelection();if(h!=null){try{var q=getCaretPosition(h.getRangeAt(0).startContainer.parentNode,j,j.document);var p=h.getRangeAt(0).startContainer.parentNode.innerHTML;if(p.endsWith("<br>")&&i.length){i+="<br>";f="<br>"+f}var s=true;if(!d(p)){lz_he_setHTML(f,l)}else{if(i.endsWith("&nbsp;")||i.endsWith(" ")||!$.trim(i).length||!p.endsWith(i)){lz_he_insertHTML(f,l);s=false}else{var a=p.substr(0,q-i.length);var k=p.substr(q,p.length-q);var n=a+f+k;var e=h.getRangeAt(0).startContainer.parentNode;if("html-link".indexOf(e.tagName.toLowerCase())==-1){e.innerHTML=n}}}lz_he_setFocus(l);if(s){var m=j.document.createRange();m.selectNodeContents(e);m.collapse(false);h=j.getSelection();h.removeAllRanges();h.addRange(m)}}catch(o){console.log(o)}}}return null}function getCaretPosition(h,k,j){var e=k.getSelection().getRangeAt(0),a=e.cloneRange(),i,f=j.createElement("div");a.selectNodeContents(h);a.setEnd(e.endContainer,e.endOffset);f.appendChild(a.cloneContents());i=f.innerHTML.length;return i}function lz_he_getCursorPosition(e){if(document.getElementById("wysiwyg"+e)!=null){var h=document.getElementById("wysiwyg"+e).contentWindow;var f=h.document.getSelection();if(f!=null){try{return f.baseOffset}catch(a){}}}return null}function lz_he_getHTML(a){if(document.getElementById("wysiwyg"+a)!=null){var e=document.getElementById("wysiwyg"+a).contentWindow.document.body.innerHTML;e=e.replace(/&amp;([#a-zA-Z0-9]*?);/g,"%%%$1%%%");e=e.replace(/&amp;/g,"&");e=e.replace(/%%%([#a-zA-Z0-9]*?)%%%/g,"&amp;$1;");return e}else{return""}}function lz_he_getBODY(a){if(document.getElementById("wysiwyg"+a)!=null){return document.getElementById("wysiwyg"+a).contentWindow.document.body}return null}function lz_he_getText(h,k){if(document.getElementById("wysiwyg"+h)!=null){var j=document.getElementById("wysiwyg"+h).contentWindow.document.body.innerText;if(k){for(var f=0;f<document.getElementById("wysiwyg"+h).contentWindow.document.getElementsByTagName("a").length;f++){var e=document.getElementById("wysiwyg"+h).contentWindow.document.getElementsByTagName("a")[f];j=j.replace(e.innerText,e.innerText+": "+e.href)}}j=j.replace(/\n\n\n/g,"\n\n");return j}else{return""}}function lz_he_getSelectedText(a){return grabSelectedText(a)}function lz_he_insertHTML(f,k){var a,j=document.getElementById("wysiwyg"+k).contentWindow;var i=j.document;if(i.selection){a=i.selection.createRange();a.pasteHTML(f)}else{if(i.getSelection){try{a=i.getSelection().getRangeAt(0);var h=i.createElement("div");a.surroundContents(h);h.innerHTML=f}catch(e){lz_he_setHTML(f,k)}}}}function lz_he_setHTML(a,e){if(document.getElementById("wysiwyg"+e)!=null){if(a=="<br>"){return}document.getElementById("wysiwyg"+e).contentWindow.document.body.innerHTML=a}}function lz_he_setItalic(a){formatText("italic",a)}function lz_he_setUnderline(a){formatText("underline",a)}function lz_he_setBold(a){formatText("bold",a)}function lz_he_setNoStyle(a){formatText("removeFormat",a)}function lz_he_switchDisplayMode(a){formatText("htmlmode",a)}function lz_he_setFontName(a,e){formatFontName(a,e)}function lz_he_setFontSize(a,e){if(document.getElementById("wysiwyg"+e)!=null){document.getElementById("wysiwyg"+e).contentWindow.document.execCommand("fontsize",false,a)}}function lz_he_setFontColor(e,a){if(document.getElementById("wysiwyg"+a)!=null){document.getElementById("wysiwyg"+a).contentWindow.document.execCommand("forecolor",false,e)}}function lz_he_setFocus(a){function e(f){if(document.getElementById("wysiwyg"+f)!=null){document.getElementById("wysiwyg"+f).contentWindow.focus();document.getElementById("wysiwyg"+f).contentWindow.document.body.focus()}}e(a)}function lz_he_removeFocus(a){if(document.getElementById("wysiwyg"+a)!=null){document.getElementById("wysiwyg"+a).contentWindow.blur()}}function lz_he_onEnterPressed(a){m_EnterCallBackFunction=a}wyzzW=100;wyzzH=100;var m_SizeUnitWidth="%";var m_SizeUnitHeight="%";var m_ControlId="";var m_EnterCallBackFunction=null;toolbarCount=0;xhtml_out=0;var myFonts=["Andale Mono","Georgia","Verdana","Arial","Arial Black","impact","Times New Roman","Courier New","Comic Sans MS","Helvetica","Trebuchet MS","Tahoma"];var specialChars=["&copy;","&reg;","&#153;","&agrave;","&aacute;","&ccedil;","&egrave;","&eacute;","&euml;","&igrave;","&iacute;","&ntilde;","&ograve;","&oacute;","&ouml;","&ugrave;","&uacute;","&uuml;","&pound;","&cent;","&yen;","&euro;","&#147;","&#148;","&laquo;","&raquo;","&#149;","&#151;","&#133;","&para;","&#8224;","&#8225;","&times;","&divide;","&deg;","&plusmn;","&frac14;","&frac12;","&frac34;","&not;","&lt;","&gt;","&Delta;","&lambda;","&Phi;","&Psi;","&Sigma;","&int;","&alpha;","&beta;","&Omega;","&mu;","&pi;","&theta;","&harr;","&infin;","&radic;","&asymp;","&ne;","&equiv;","&le;","&ge;","&iexcl;","&iquest;","&spades;","&clubs;","&hearts;","&diams;"];version="0.66";mode=1;browserName=navigator.appName;if(navigator.userAgent.indexOf("Safari")!=-1){browserName="Safari"}if(navigator.userAgent.indexOf("Chrome")!=-1){browserName="Chrome"}if(navigator.userAgent.indexOf("Firefox")!=-1){browserName="Firefox"}if(navigator.userAgent.indexOf("Trident")!=-1){browserName="Microsoft Internet Explorer"}nlBefore=["div","p","li","h1","h2","h3","h4","h5","h6","hr","ul","ol"];function h2x(l,o){var f="";var n;var m;for(n=0;n<l.childNodes.length;n++){if(l.childNodes[n].parentNode&&String(l.tagName).toLowerCase()!=String(l.childNodes[n].parentNode.tagName).toLowerCase()){continue}switch(l.childNodes[n].nodeType){case 1:var s=String(l.childNodes[n].tagName).toLowerCase();if(s==""){break}if((indexOf(nlBefore,s)!=-1)&&(!o)){f+="\n"}f+="<"+s;var p=l.childNodes[n].attributes;var t;for(m=0;m<p.length;m++){var h=p[m].nodeName.toLowerCase();if(!p[m].specified){continue}var a=true;switch(h){case"style":t=l.childNodes[n].style.cssText;break;case"class":t=l.childNodes[n].className;break;case"name":t=l.childNodes[n].name;break;default:try{t=l.childNodes[n].getAttribute(h,2)}catch(q){a=false}}if(a){if(!(s=="li"&&h=="value")){f+=" "+h+'="'+fixatt(t)+'"'}}}if(s=="img"&&h=="alt"){f+=' alt=""'}if(l.childNodes[n].canHaveChildren||l.childNodes[n].hasChildNodes()){f+=">";f+=h2x(l.childNodes[n],s=="pre"?true:false);f+="</"+s+">"}else{if(s=="style"||s=="title"||s=="script"||s=="textarea"||s=="a"){f+=">";var k;if(s=="script"){k=l.childNodes[n].text}else{k=l.childNodes[n].innerHTML}if(s=="style"){k=String(k).replace(/[\n]+/g,"\n")}f+=k+"</"+s+">"}else{f+="/>"}}break;case 3:if(!o){if(l.childNodes[n]!="\n"){f+=fixents(fixtext(l.childNodes[n].nodeValue))}}else{f+=l.childNodes[n].nodeValue;break}default:break}}return f}function fixents(l){var h;var a={8364:"euro",402:"fnof",8240:"permil",352:"Scaron",338:"OElig",381:"#381",8482:"trade",353:"scaron",339:"oelig",382:"#382",376:"Yuml",162:"cent",163:"pound",164:"curren",165:"yen",166:"brvbar",167:"sect",168:"uml",169:"copy",170:"ordf",171:"laquo",172:"not",173:"shy",174:"reg",175:"macr",176:"deg",177:"plusmn",178:"sup2",179:"sup3",180:"acute",181:"micro",182:"para",183:"middot",184:"cedil",185:"sup1",186:"ordm",187:"raquo",188:"frac14",189:"frac12",190:"frac34",191:"iquest",192:"Agrave",193:"Aacute",194:"Acirc",195:"Atilde",196:"Auml",197:"Aring",198:"AElig",199:"Ccedil",200:"Egrave",201:"Eacute",202:"Ecirc",203:"Euml",204:"Igrave",205:"Iacute",206:"Icirc",207:"Iuml",208:"ETH",209:"Ntilde",210:"Ograve",211:"Oacute",212:"Ocirc",213:"Otilde",214:"Ouml",215:"times",216:"Oslash",217:"Ugrave",218:"Uacute",219:"Ucirc",220:"Uuml",221:"Yacute",222:"THORN",223:"szlig",224:"agrave",225:"aacute",226:"acirc",227:"atilde",228:"auml",229:"aring",230:"aelig",231:"ccedil",232:"egrave",233:"eacute",234:"ecirc",235:"euml",236:"igrave",237:"iacute",238:"icirc",239:"iuml",240:"eth",241:"ntilde",242:"ograve",243:"oacute",244:"ocirc",245:"otilde",246:"ouml",247:"divide",248:"oslash",249:"ugrave",250:"uacute",251:"ucirc",252:"uuml",253:"yacute",254:"thorn",255:"yuml",913:"Alpha",914:"Beta",915:"Gamma",916:"Delta",917:"Epsilon",918:"Zeta",919:"Eta",920:"Theta",921:"Iota",922:"Kappa",923:"Lambda",924:"Mu",925:"Nu",926:"Xi",927:"Omicron",928:"Pi",929:"Rho",931:"Sigma",932:"Tau",933:"Upsilon",934:"Phi",935:"Chi",936:"Psi",937:"Omega",8756:"there4",8869:"perp",945:"alpha",946:"beta",947:"gamma",948:"delta",949:"epsilon",950:"zeta",951:"eta",952:"theta",953:"iota",954:"kappa",955:"lambda",956:"mu",957:"nu",968:"xi",969:"omicron",960:"pi",961:"rho",962:"sigmaf",963:"sigma",964:"tau",965:"upsilon",966:"phi",967:"chi",968:"psi",969:"omega",8254:"oline",8804:"le",8260:"frasl",8734:"infin",8747:"int",9827:"clubs",9830:"diams",9829:"hearts",9824:"spades",8596:"harr",8592:"larr",8594:"rarr",8593:"uarr",8595:"darr",8220:"ldquo",8221:"rdquo",8222:"bdquo",8805:"ge",8733:"prop",8706:"part",8226:"bull",8800:"ne",8801:"equiv",8776:"asymp",8230:"hellip",8212:"mdash",8745:"cap",8746:"cup",8835:"sup",8839:"supe",8834:"sub",8838:"sube",8712:"isin",8715:"ni",8736:"ang",8711:"nabla",8719:"prod",8730:"radic",8743:"and",8744:"or",8660:"hArr",8658:"rArr",9674:"loz",8721:"sum",8704:"forall",8707:"exist",8216:"lsquo",8217:"rsquo",161:"iexcl",977:"thetasym",978:"upsih",982:"piv",8242:"prime",8243:"Prime",8472:"weierp",8465:"image",8476:"real",8501:"alefsym",8629:"crarr",8656:"lArr",8657:"uArr",8659:"dArr",8709:"empty",8713:"notin",8727:"lowast",8764:"sim",8773:"cong",8836:"nsub",8853:"oplus",8855:"otimes",8901:"sdot",8968:"lceil",8969:"rceil",8970:"lfloor",8971:"rfloor",9001:"lang",9002:"rang",710:"circ",732:"tilde",8194:"ensp",8195:"emsp",8201:"thinsp",8204:"zwnj",8205:"zwj",8206:"lrm",8207:"rlm",8211:"ndash",8218:"sbquo",8224:"dagger",8225:"Dagger",8249:"lsaquo",8250:"rsaquo"};var f="";var e=new RegExp();e.compile("[a]|[^a]","g");var k=l.match(e);if(!k){return l}for(h=0;h<k.length;h++){var j=parseInt(k[h].charCodeAt());if(a[j]){f+="&"+a[j]+";"}else{f+=k[h]}}return f}function fixtext(e){var a=String(e).replace(/\&lt;/g,"#h2x_lt").replace(/\&gt;/g,"#h2x_gt");a=a.replace(/\n{2,}/g,"\n").replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\u00A0/g,"&nbsp;");return a.replace(/#h2x_lt/g,"&alt;").replace(/#h2x_gt/g,"&gt;")}function fixatt(e){var a=String(e).replace(/\&lt;/g,"#h2x_lt").replace(/\&gt;/g,"#h2x_gt");a=a.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;");return a.replace(/#h2x_lt/g,"&alt;").replace(/#h2x_gt/g,"&gt;")}function indexOf(f,e){var a;for(a=0;a<f.length;a++){if(f[a]==e){return a}}return -1}var buttonColors=new Array(216);function getColorArray(){c=new Array("00","33","66","99","cc","ff");var a=0;for(r=0;r<6;r++){for(g=0;g<6;g++){for(b=0;b<6;b++){buttonColors[a]=c[r]+c[g]+c[b];a++}}}}getColorArray();if((typeof Range!=="undefined")&&!Range.prototype.createContextualFragment){Range.prototype.createContextualFragment=function(a){var f=document.createDocumentFragment(),e=document.createElement("div");f.appendChild(e);e.outerHTML=a;return f}}if(typeof HTMLElement!="undefined"){if(typeof HTMLElement.insertAdjacentHTML=="undefined"){HTMLElement.prototype.insertAdjacentElement=function(a,e){switch(a){case"beforeBegin":this.parentNode.insertBefore(e,this);break;case"afterBegin":this.insertBefore(e,this.firstChild);break;case"beforeEnd":this.appendChild(e);break;case"afterEnd":if(this.nextSibling){this.parentNode.insertBefore(e,this.nextSibling)}else{this.parentNode.appendChild(e)}break}}}if(typeof HTMLElement.insertAdjacentHTML=="undefined"){HTMLElement.prototype.insertAdjacentHTML=function(e,h){var f=this.ownerDocument.createRange();f.setStartBefore(this);var a=f.createContextualFragment(h);this.insertAdjacentElement(e,a)}}if(typeof HTMLElement.insertAdjacentText=="undefined"){HTMLElement.prototype.insertAdjacentText=function(e,f){var a=document.createTextNode(f);this.insertAdjacentElement(e,a)}}}function closeColorPicker(a){document.getElementById(a).style.display="none"}function insertLink(k){var i="";var f="";var e="";var a=grabSelectedText(k);var f=prompt("Enter the target URL of the link:");var e=prompt("Please give a title for the link:");var j=confirm("Should this link open in a new window?\n\nOK = Open in NEW Window\nCancel = Open in THIS window");if(j){i="blank"}else{i="self"}if(i==""||f==""||e==""){alert("Please enter all the required information.");insertLink(k)}else{var h='<a href="'+f+'" target="_'+i+'" title="'+e+'">'+a+"</a>";insertHTML(h,k)}}function insertImage(h){var f=prompt("Enter the target URL of the image:");var e=prompt("Please give a title for the link:");var a='<img src="'+f+'" title="'+e+'" />';insertHTML(a,h)}function make_wyzz(k){if(document.getElementById(k)!=null){document.getElementById(k).style.display="none";var l=k;m_ControlId=l;var e=parseFloat(wyzzW)+2;var f='<iframe frameborder="0" id="wysiwyg'+l+'"></iframe>\n\n';document.getElementById(l).insertAdjacentHTML("afterEnd",f);document.getElementById("wysiwyg"+l).style.height=wyzzH+m_SizeUnitHeight;document.getElementById("wysiwyg"+l).style.width=wyzzW+m_SizeUnitWidth;var h=document.getElementById(l).value;var a,j=document.getElementById("wysiwyg"+l).contentWindow.document;j.open();j.write('<html><head></head><link rel="stylesheet" type="text/css" href="js/wyzz/style.css"/><body id="body-'+l+'">'+h+"</body></html>");j.close();if(j.addEventListener){j.addEventListener("keypress",j.defaultView.parent.catchInputs,false);j.addEventListener("click",function(m){lzm_chatDisplay.RemoveAllContextMenus()})}else{if(j.attachEvent){j.attachEvent("onkeypress",j.defaultView.parent.catchInputs)}}$(j).on("paste",function(n){try{if(d((n.originalEvent||n).clipboardData.getData)){n.preventDefault();var o=(n.originalEvent||n).clipboardData.getData("text/plain")||prompt("Paste something..");j.execCommand("insertHTML",false,o);return}}catch(m){deblog(m)}});if(browserName=="Microsoft Internet Explorer"){j.body.contentEditable=true}else{j.designMode="on"}if(browserName=="Microsoft Internet Explorer"||browserName=="Opera"){for(a=0;a<document.forms.length;a++){document.forms[a].attachEvent("onsubmit",function(){updateTextArea(l)})}}else{for(a=0;a<document.forms.length;a++){document.forms[a].addEventListener("submit",function i(){updateTextArea(l)},true)}}if(IFManager.IsDesktopApp()&&typeof(window.top.SpellCheck)!="undefined"){ContextMenuClass.AddContextMenuListenerToElement(j.body,window.top.SpellCheck.SuggestionMenuBuilder,"contextmenu")}}}function placeCaretAtStart(e){var j=e.contentWindow;var i=j.document;if(j.getSelection&&i.createRange){var h=j.getSelection();var a=i.createRange();a.selectNodeContents(i.body);a.collapse(true);h.removeAllRanges();h.addRange(a)}else{if(i.selection&&i.body.createTextRange){var f=i.body.createTextRange();f.collapse(true);f.select()}}}function placeCaretAtEnd(e){var j=e.contentWindow;var i=j.document;i.body.focus();if(j.getSelection&&i.createRange){var a=i.createRange();a.selectNodeContents(i.body);a.collapse(false);var h=j.getSelection();h.removeAllRanges();h.addRange(a)}else{if(i.selection&&i.body.createTextRange){var f=i.body.createTextRange();f.moveToElementText(el);f.collapse(false);f.select()}}}function pnl2br(a){a=lz_global_trim(a);a=(a+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"<br>").replace(/<br><br>/g,"<br>");return a}function formatTextColor(a,f,e){if(browserName=="Microsoft Internet Explorer"||browserName=="Chrome"){a="#"+a}document.getElementById("wysiwyg"+f).contentWindow.document.execCommand("forecolor",false,a)}function formatBackColor(a,f,e){if(browserName=="Microsoft Internet Explorer"||browserName=="Chrome"){a="#"+a}if(browserName=="Microsoft Internet Explorer"){document.getElementById("wysiwyg"+f).contentWindow.document.execCommand("backcolor",false,a)}else{document.getElementById("wysiwyg"+f).contentWindow.document.execCommand("hilitecolor",false,a)}}function formatFontName(e,f,a){document.getElementById("wysiwyg"+f).contentWindow.document.execCommand("fontName",false,e)}function formatSpecialChar(a,f,e){lz_he_insertHTML(a,f)}function formatHeader(a,f,e){document.getElementById("wysiwyg"+f).contentWindow.document.execCommand("formatBlock",false,"<"+a+">")}function formatText(e,f,i){if(mode==0&&e!="htmlmode"){alert('Function unavailable in "View Source" mode')}else{document.getElementById("wysiwyg"+f).contentWindow.focus();if(e=="upsize"){var m=document.getElementById("wysiwyg"+f).contentWindow.document.queryCommandValue("FontSize");if(m==""||!m){m=3}if(m<7){var o=parseInt(m)+1}else{var o=m}document.getElementById("wysiwyg"+f).contentWindow.document.execCommand("FontSize",false,o)}else{if(e=="downsize"){var m=document.getElementById("wysiwyg"+f).contentWindow.document.queryCommandValue("FontSize");if(m>1){var o=m-1}else{var o=m}document.getElementById("wysiwyg"+f).contentWindow.document.execCommand("FontSize",false,o)}else{if(e=="forecolor"){if(document.getElementById("colorpicker"+f).style.display==""){document.getElementById("colorpicker"+f).style.display="none"}else{document.getElementById("colorpicker"+f).style.display=""}}else{if(e=="backcolor"){if(document.getElementById("colorbackpicker"+f).style.display==""){document.getElementById("colorbackpicker"+f).style.display="none"}else{document.getElementById("colorbackpicker"+f).style.display=""}}else{if(e=="font"){if(document.getElementById("fontpicker"+f).style.display==""){document.getElementById("fontpicker"+f).style.display="none"}else{document.getElementById("fontpicker"+f).style.display=""}}else{if(e=="specialchar"){if(document.getElementById("specialpicker"+f).style.display==""){document.getElementById("specialpicker"+f).style.display="none"}else{document.getElementById("specialpicker"+f).style.display=""}}else{if(e=="headers"){if(document.getElementById("headerpicker"+f).style.display==""){document.getElementById("headerpicker"+f).style.display="none"}else{document.getElementById("headerpicker"+f).style.display=""}}else{if(e=="htmlmode"){var j=document.getElementById("wysiwyg"+f).contentWindow.document;if(mode==1){if(navigator.appName=="Microsoft Internet Explorer"||browserName=="Opera"){var h=j.body.innerHTML;j.body.innerText=h}else{var k=document.createTextNode(j.body.innerHTML);j.body.innerHTML="";j.body.appendChild(k)}j.body.style.fontSize="12px";j.body.style.fontFamily="Courier New";mode=0}else{if(navigator.appName=="Microsoft Internet Explorer"||browserName=="Opera"){var a=j.body.innerText;j.body.innerHTML=a}else{var k=j.body.ownerDocument.createRange();k.selectNodeContents(j.body);j.body.innerHTML=k.toString()}mode=1}}else{if(e=="help"){if(document.getElementById("helpbox"+f).style.display==""){document.getElementById("helpbox"+f).style.display="none"}else{document.getElementById("helpbox"+f).style.display=""}}else{if(e=="link"){if(browserName=="Microsoft Internet Explorer"){var l=confirm("Should this link open in a new window?\n\nOK = Open in NEW Window\nCancel = Open in THIS window");document.getElementById("wysiwyg"+f).contentWindow.document.execCommand("createLink",true," ");if(l==true){document.getElementById("wysiwyg"+f).contentWindow.document.selection.createRange().parentElement().target="_blank"}}else{insertLink(f)}}else{if(e=="insertimage"){if(browserName=="Microsoft Internet Explorer"){document.getElementById("wysiwyg"+f).contentWindow.document.execCommand(e,true,null)}else{insertImage(f)}}else{document.getElementById("wysiwyg"+f).contentWindow.document.execCommand(e,false,null)}}}}}}}}}}}}}function updateTextArea(a){if(xhtml_out==1){document.getElementById(a).value=h2x(document.getElementById("wysiwyg"+a).contentWindow.document.body)}else{document.getElementById(a).value=document.getElementById("wysiwyg"+a).contentWindow.document.body.innerHTML}}function grabSelectedText(h){var f="";if(browserName=="Microsoft Internet Explorer"||browserName=="Opera"){var a=document.getElementById("wysiwyg"+h).contentWindow.document.selection;if(a.type=="Text"){var e=a.createRange();f=e.text}}else{var f=document.getElementById("wysiwyg"+h).contentWindow.document.getSelection()}return f}function catchInputs(a){if(m_EnterCallBackFunction==null){return}if(a.which==13||a.keyCode==13||(a.keyCode==10&&a.ctrlKey)){if(a.ctrlKey==1||a.ctrlKey){ChatEditorClass.ActiveEditor.execute("insertHTML","<br><br>");return true}setTimeout(m_EnterCallBackFunction,1);(a.preventDefault)?a.preventDefault():a.returnValue=false;return false}return true};